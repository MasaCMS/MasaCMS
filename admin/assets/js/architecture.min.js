/* This file is part of Mura CMS.

	Mura CMS is free software: you can redistribute it and/or modify
	it under the terms of the GNU General Public License as published by
	the Free Software Foundation, Version 2 of the License.

	Mura CMS is distributed in the hope that it will be useful,
	but WITHOUT ANY WARRANTY; without even the implied warranty of
	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
	GNU General Public License for more details.

	You should have received a copy of the GNU General Public License
	along with Mura CMS.  If not, see <http://www.gnu.org/licenses/>.

	Linking Mura CMS statically or dynamically with other modules constitutes the preparation of a derivative work based on
	Mura CMS. Thus, the terms and conditions of the GNU General Public License version 2 ("GPL") cover the entire combined work.

	However, as a special exception, the copyright holders of Mura CMS grant you permission to combine Mura CMS with programs
	or libraries that are released under the GNU Lesser General Public License version 2.1.

	In addition, as a special exception, the copyright holders of Mura CMS grant you permission to combine Mura CMS with
	independent software modules (plugins, themes and bundles), and to distribute these plugins, themes and bundles without
	Mura CMS under the license of your choice, provided that you follow these specific guidelines:

	Your custom code

	• Must not alter any default objects in the Mura CMS database and
	• May not alter the default display of the Mura CMS logo within Mura CMS and
	• Must not alter any files in the following directories.

	/admin/
	/core/
	/Application.cfc
	/index.cfm

	You may copy and distribute Mura CMS with a plug-in, theme or bundle that meets the above guidelines as a combined work
	under the terms of GPL for Mura CMS, provided that you include the source code of that other code when and as the GNU GPL
	requires distribution of source code.

	For clarity, if you create a modified version of Mura CMS, you are not obligated to grant this special exception for your
	modified version; it is your choice whether to do so, or to make such modified version available under the GNU General Public License
	verion 2 without this exception.  You may, if you choose, apply this exception to your own modified versions of Mura CMS. */
function initConfigurator(t,e){return siteManager.initConfigurator(t,e)}var siteManager={formSubmitted:!1,layoutmanager:!1,fileLockConfirmed:!1,hasFileLock:!1,nodeLockConfirmed:!1,hasNodeLock:!1,dirtyRelatedContent:!1,currentModuleID:"",copyContentID:"",copyModuleID:"",copySiteID:"",reloadURL:"",tablist:"",
//submitDialogs:[{type:'alert',message:'test1',condition:function(){return true}},{type:'confirmation',message:'test2',condition:function(){return true}}],
submitDialogs:[],submitActions:[],assigningChangeset:!1,addSubmitDialog:function(t){siteManager.submitDialogs.push(t)},addSubmitAction:function(t){siteManager.submitActions.push(t)},submitContentForm:function(){function r(){var t;for(t in CKEDITOR.instances)CKEDITOR.instances[t].updateElement();for(t=0;t<c.length;t++)if(t==s){var e=c[t];if("confirmation"==e.type.toLowerCase()){if("function"!=typeof e.condition)return confirmDialog($.extend(e,{yesAction:function(){s++,r()}})),!1;var i=function(){s++,r()},a=null;if("function"==typeof e.yesFn&&(i=function(){e.yesFn()&&(s++,r())}),"function"==typeof e.noFn&&(a=function(){e.noFn()&&(s++,r())}),"function"!=typeof e.condition)return confirmDialog($.extend(e,{yesAction:i,noAction:a})),!1;if(e.condition(e))return confirmDialog($.extend(e,{yesAction:i,noAction:a})),!1;s++}else if("alert"==e.type.toLowerCase()){var n=function(){s++,r()};if("function"==typeof e.okFn&&(n=function(){e.okFn()&&(s++,r())}),"function"!=typeof e.condition)return alertDialog($.extend(e,{okAction:n})),!1;if(e.condition(e))return alertDialog($.extend(e,{okAction:n})),!1;s++}else if("validation"==e.type.toLowerCase())if("function"==typeof e.condition){if(e.condition(e)){var n=function(){s++,r()};return"function"==typeof e.okFn&&(n=function(){e.okFn()&&(s++,r())}),alertDialog($.extend(e,{okAction:n})),!1}s++}else s++;else s++}if(s==c.length){for(var t=0;t<d.length;t++){var o=d[t]();if("boolean"==typeof o&&!o)return!1}siteManager.assigningChangeset&&($("#changesetID").val(currentChangesetSelection),$("#removePreviousChangeset").val(document.getElementById("_removePreviousChangeset").checked),"other"==currentChangesetSelection?$("#changesetname").val($("#_changesetname").val()):$("#changesetname").val("")),siteManager.formSubmitted=!0,actionModal(function(){document.contentForm.submit()})}}var s=0,t=!1,c=siteManager.submitDialogs,d=siteManager.submitActions;r()},ckContent:function(t,e){var i=!1,a;if("undefined"!=typeof isFormBuilder&&!siteManager.saveFormBuilder())return alertDialog("All fields must have a 'name' before the form can be saved."),!1;if(void 0!==document.contentForm.display)if("2"==document.contentForm.display.value){var n=$(".datepicker.mura-datepickerdisplayStart").val(),o=$(".datepicker.mura-datepickerdisplayStop").val();
//alert(tempStart);
if(0==isDate(n,"DISPLAY START DATE"))return alertDialog("Please enter a valid date in the 'Display Start Date' field"),!1;if(""!=o&&0==isDate(o,"DISPLAY STOP DATE"))return alertDialog("Please enter a valid date in the 'Display Stop Date' field"),!1}else $(".datepicker.mura-datepickerdisplayStart").val(""),$(".datepicker.mura-datepickerdisplayStop").val(""),$("#mura-displayStart").val(""),$("#mura-displayStop").val("");if(""==document.contentForm.title.value)return"Component"==document.contentForm.type.value?alertDialog("The form field 'Menu Title' is required"):"Form"==document.contentForm.type.value?alertDialog("The form field 'Title' is required"):alertDialog("The form field 'Long Title' is required"),!1;if("Link"==document.contentForm.type.value&&""==document.contentForm.body.value)return alertDialog("The form field 'URL' is required"),!1;if(!validateForm(document.contentForm))return!1;if(1==document.contentForm.approved.value&&""!=t&&!confirm(t))return!1;if(void 0!==this.hasFileLock&&!this.fileLockConfirmed&&this.hasFileLock&&""!=$("input[name='newfile']").val())return confirmDialog(this.unlockfileconfirm,function(){
//alert('true')
$("#unlockfilewithnew").val("true"),siteManager.ckContent(!1)&&siteManager.submitContentForm()},function(){
//alert('false')
$("#unlockfilewithnew").val("false"),siteManager.ckContent(!1)&&siteManager.submitContentForm()}),!(this.fileLockConfirmed=!0);if(e)return!0;if(void 0!==this.hasNodeLock&&this.hasNodeLock&&!this.nodeLockConfirmed)
//			alert('b')
return confirmDialog(this.unlocknodeconfirm,function(){
//alert('true')
$("#unlocknodewithpublish").val("true"),siteManager.ckContent(!1)&&siteManager.submitContentForm()},function(){
//alert('false')
$("#unlocknodewithpublish").val("false"),siteManager.ckContent(!1)&&siteManager.submitContentForm()}),!(this.nodeLockConfirmed=!0);
//alert(document.contentForm.muraPreviouslyApproved)
//alert(document.contentForm.approved.value)
//alert(cancelPendingApproval)
if(0==document.contentForm.muraPreviouslyApproved.value&&1==document.contentForm.approved.value)return"undefined"!=typeof currentChangesetID&&""!=currentChangesetID?confirmDialog(publishitemfromchangeset,function(){siteManager.submitContentForm()}):"undefined"!=pendingApproval&&pendingApproval?confirmDialog(cancelPendingApproval,function(){document.contentForm.cancelpendingapproval.value="true",siteManager.submitContentForm()},function(){document.contentForm.cancelpendingapproval.value="false",siteManager.submitContentForm()}):siteManager.submitContentForm(),!1;if(1)return siteManager.submitContentForm(),!1;var r=new FormData(document.contentForm);$.ajax({url:$(document.contentForm).attr("action"),type:"post",data:r})},
//  DHTML Menu for Site Summary
DHTML:document.getElementById||document.all||document.layers,lastid:"",getObj:function(t){document.getElementById?(this.obj=document.getElementById(t),this.style=document.getElementById(t).style):document.all?(this.obj=document.all[t],this.style=document.all[t].style):document.layers&&(this.obj=document.layers[t],this.style=document.layers[t])},saveFormBuilder:function(){var t;return!!$("#mura-templatebuilder").templatebuilder("iscomplete")&&(jQuery("#mura-templatebuilder").templatebuilder("save"),!0)},openNewContentMenu:function(i,a,t,n,o,r){return $("#newContentMenuContainer").remove(),$("body").append('<div id="newContentMenuContainer" title="Loading..." style="display:none"><div id="newContentMenu"><div class="load-inline"></div></div></div>'),$("#newContentMenuContainer").dialog({resizable:!1,modal:!0,width:552,title:newContentMenuTitle,position:getDialogPosition(),
/*
buttons: {
					Cancel: function() {
							$( this ).dialog( "close" );
					}
				},
*/
open:function(){$("#newContentMenuContainer").html('<div class="ui-dialog-content ui-widget-content"><div class="load-inline"></div></div>');var t="./",e="muraAction=cArch.loadnewcontentmenu&siteid="+a+"&contentid="+i+"&parentid="+n+"&topid="+n+"&ptype="+o+"&moduleid="+r+"&cacheid="+Math.random();$("#newContentMenuContainer .load-inline").spin(spinnerArgs2),$.get("./?"+e,function(t){$("#newContentMenuContainer .load-inline").spin(!1),$("#newContentMenuContainer").html(t),$("#newContentMenuContainer").dialog("option","position",{my:"center",at:"center",of:window}),setToolTips(".add-content-ui")})},close:function(){$(this).dialog("destroy"),$("#newContentMenuContainer").remove()}}),!1},showMenu:function(t,e,i,a,n,o,r,s,c){var d=e.toLowerCase();if(window.innerHeight)var l=window.pageYOffset;else if(document.documentElement&&document.documentElement.scrollTop)var l=document.documentElement.scrollTop;else if(document.body)var l=document.body.scrollTop;if(window.innerWidth)var u=window.pageXOffset;else if(document.documentElement&&document.documentElement.scrollLeft)var u=document.documentElement.scrollLeft;else if(document.body)var u=document.body.scrollLeft;var g=this.findPosX(i),f=this.findPosY(i);g-=10,document.getElementById("newZoom").style.display="none",document.getElementById("newZoomLink").style.display="none",document.getElementById("newCopy").style.display="none",document.getElementById("newCopyLink").style.display="none",document.getElementById("newCopyAll").style.display="none",document.getElementById("newCopyAllLink").style.display="none",document.getElementById("newPaste").style.display="none",document.getElementById("newPasteLink").style.display="none",document.getElementById("newContentLink").style.display="none",document.getElementById("newContent").style.display="none",document.getElementById("newZoomLink").onclick=function(){return siteManager.loadSiteManagerInTab(function(){return siteManager.loadSiteManager(r,a,c,"","",s,1)}),!1},document.getElementById("newZoom").style.display="",document.getElementById("newZoomLink").style.display="","none"!=d&&"00000000000000000000000000000000099"!=c&&"module"!=s.toLowerCase()&&(document.getElementById("newCopyLink").href="javascript:siteManager.copyThis('"+r+"', '"+a+"','false')",document.getElementById("newCopyAllLink").href="javascript:siteManager.copyThis('"+r+"', '"+a+"','true')",document.getElementById("newCopy").style.display="",document.getElementById("newCopyLink").style.display="",document.getElementById("newCopyAll").style.display="",document.getElementById("newCopyAllLink").style.display="");for(
// append action links
var m=i.parentNode.parentNode.getElementsByClassName("actions")[0].getElementsByTagName("ul")[0].getElementsByTagName("li"),p=document.getElementById("newContentOptions"),h=p.getElementsByClassName("li-action"),y;y=h[0];)y.parentNode.removeChild(y);
// create new links
for(var v=document.getElementById("newZoom"),b=0;b<m.length;b++)if(m[b].className.indexOf("disabled")<0){var C=document.createElement("li");C.innerHTML=m[b].innerHTML;var M=C.getElementsByTagName("a")[0],j=M.getAttribute("title");C.className="li-action "+j.toLowerCase(),M.removeAttribute("title"),M.innerHTML=M.innerHTML+j,"edit"==j.toLowerCase()?p.insertBefore(C,v.nextSibling):p.appendChild(C)}"author"!=d&&"editor"!=d||"00000000000000000000000000000000099"==c||(document.getElementById("newContentLink").onclick=function(){return siteManager.openNewContentMenu(a,r,n,o,s,c),!1},
//.href='./?muraAction=cArch.edit&contentid=&parentid=' + contentid + '&type=Page&topid=' + topid + '&siteid=' + siteid + '&moduleid=00000000000000000000000000000000000&ptype=' + type;
//var test=this.copySiteID != "" && this.copyContentID != "" && this.copyModuleID==this.currentModuleID;
""!=this.copySiteID&&""!=this.copyContentID&&this.copyModuleID==this.currentModuleID&&(document.getElementById("newPasteLink").href="javascript:siteManager.pasteThis('"+a+"')",document.getElementById("newPaste").style.display="",document.getElementById("newPasteLink").style.display=""),
//if (type!='File' && type!='Link'){
document.getElementById("newContentLink").style.display="",document.getElementById("newContent").style.display="",document.getElementById("newCopy").style.border=""),document.getElementById(t).style.top=f+"px",document.getElementById(t).style.left=g+"px",$("#"+t).removeClass("hide"),""!=this.lastid&&this.lastid!=t&&this.hideMenu(this.lastid),
// this.navTimer = setTimeout('siteManager.hideMenu(siteManager.lastid);', 100000);
this.lastid=t},findPosX:function(t){var e=0;if(t.offsetParent)for(;t.offsetParent;)e+=t.offsetLeft,t=t.offsetParent;else t.x&&(e+=t.x);return e},findPosY:function(t){var e=0;if(t.offsetParent)for(;t.offsetParent;)e+=t.offsetTop,t=t.offsetParent;else t.y&&(e+=t.y);return e},keepMenu:function(t){
//		this.navTimer = setTimeout('hideMenu(lastid);', 100000);
$("#"+t).removeClass("hide");
//document.getElementById(id).style.display="block";
},hideMenu:function(t){
//	if(this.navTimer != null) clearTimeout(this.navTimer);
$("#"+t).addClass("hide");
//document.getElementById(id).style.display="none";
},deleteDisplayObject:function(t){var e=document.getElementById("selectedObjects"+t),i=e.selectedIndex,a=1<e.options.length?e.options.length-1:0;i<0||(e.options[i]=null,this.updateDisplayObjectList(t),e.options.length&&(e.options[e.options.length-1].selected=!0))},updateDisplayObjectList:function(t){var e=document.getElementById("selectedObjects"+t),i=document.getElementById("objectList"+t);i.value="";for(var a=0;a<e.options.length;a++)""!=i.value?i.value+="^"+e.options[a].value:i.value=e.options[a].value},moveDisplayObjectUp:function(t){var e=document.getElementById("selectedObjects"+t),i=e.selectedIndex;if(!(i<1)){var a=document.createElement("option"),n=document.createElement("option");a.text=e.options[i].text,a.value=e.value,a.selected="selected",n.text=e.options[i-1].text,n.value=e.options[i-1].value,e[i-1]=a,e[i]=n,this.updateDisplayObjectList(t)}},moveDisplayObjectDown:function(t){var e=document.getElementById("selectedObjects"+t),i=e.selectedIndex;if(i!=e.length-1){var a=document.createElement("option"),n=document.createElement("option");a.text=e.options[i].text,a.value=e.options[i].value,a.selected="selected",n.text=e.options[i+1].text,n.value=e.options[i+1].value,e.options[i+1]=a,e.options[i]=n,this.updateDisplayObjectList(t)}},setTargetParams:function(t){var e=!isNaN(t.height.value)&&0<t.height.value?",height="+t.height.value:"",i=!isNaN(t.width.value)&&0<t.width.value?",width="+t.width.value:"",a=!isNaN(t.top.value)&&0<t.top.value?",top="+t.top.value:"",n=!isNaN(t.left.value)&&0<t.left.value?",left="+t.left.value:"",o=""!=t.toolbar.value?",toolbar="+t.toolbar.value:"",r=""!=t.location.value?",location="+t.location.value:"",s=""!=t.directories.value?",directories="+t.directories.value:"",c=""!=t.status.value?",status="+t.status.value:"",d=""!=t.menubar.value?",menubar="+t.menubar.value:"",l=""!=t.resizable.value?",resizable="+t.resizable.value:"",u=""!=t.copyhistory.value?",copyhistory="+t.copyhistory.value:"",g=""!=t.scrollbars.value?",scrollbars="+t.scrollbars.value:"";document.forms.contentForm.targetParams.value=o+r+s+c+d+l+u+g+i+e+a+n},loadSiteParents:function(t,e,i,a,n){$("#mover1").hide();var o="./",r="muraAction=cArch.siteParents&compactDisplay=true&siteid="+t+"&contentid="+e+"&parentid="+i+"&keywords="+a+"&isNew="+n+"&cacheid="+Math.random(),s=$("#mover2");$.get("./?"+r,function(t){
//$('#mover2 .load-inline').spin(false);
$("#mover2").html(t),$("#mover2").show()})},loadAssocImages:function(t,e,i,a,n){var o="./",r="muraAction=cArch.assocImages&compactDisplay=true&siteid="+t+"&fileid="+e+"&contentid="+i+"&keywords="+a+"&isNew="+n+"&cacheid="+Math.random(),s=$("#selectAssocImage");$.get("./?"+r,function(t){$("#selectAssocImage").html(t),$("#selectAssocImageResults").slideDown()})},loadObjectClass:function(t,e,i,a,n,o){var r="./",s="muraAction=cArch.loadclass&compactDisplay=true&siteid="+t+"&classid="+e+"&subclassid="+i+"&contentid="+a+"&parentid="+n+"&cacheid="+Math.random();if("backEnd"==this.configuratorMode)var c=$("#classList"),d="#classList";else var c=$("#configurator"),d="#configurator";return c.html('<div class="load-inline"></div>'),$(d+" .load-inline").spin(spinnerArgs2),$.get("./?"+s,function(t){$(d+" .load-inline").spin(!1),$(d).html(t),siteManager.availableObjectTemplate="",siteManager.availalbeObjectParams={},siteManager.availableObject={},siteManager.availableObjectValidate=function(){return!0}}),!1},getDisplayObjectClass:function(t){var e,i;return $("#selectedObjects"+t).val().toString().split("~")[0]},getDisplayObjectID:function(t){var e,i;return $("#selectedObjects"+t).val().toString().split("~")[2]},loadNotify:function(t,e,i){var a="./",n="muraAction=cArch.loadNotify&compactDisplay=true&siteid="+t+"&contentid="+e+"&parentid="+i+"&cacheid="+Math.random(),o=$("#selectNotify");return""==o.html()?(o.show(),o.html('<div class="load-inline"></div>'),$("#selectNotify .load-inline").spin(spinnerArgs2),$.get("./?"+n,function(t){$("#selectNotify .load-inline").spin(!1),$("#selectNotify").html(t)})):o.toggle(),!1},loadExpiresNotify:function(t,e,i){var a="./",n="muraAction=cArch.loadExpireNotify&compactDisplay=true&siteid="+t+"&contenthistid="+e+"&parentid="+i+"&cacheid="+Math.random(),o=$("#selectExpiresNotify");return""==o.html()?(o.show(),o.html('<div class="load-inline"></div>'),$("#selectExpiresNotify .load-inline").spin(spinnerArgs2),$.get("./?"+n,function(t){$("#selectExpiresNotify .load-inline").spin(!1),$("#selectExpiresNotify").html(t)})):o.toggle(),!1},bindDelete:function(){$("a.delete").click(function(){var t=$(this).parent().attr("data-contentid");$(this).parent().remove(),siteManager.setupRCResultIcon($('#selectRelatedContent button[value="'+t+'"]')),siteManager.updateBuckets(),siteManager.updateRCForm(),$("#mura-rc-quickedit").hide()})},bindMouse:function(){$(".rcSortable li.item:not(.empty), .rcDraggable li.item").mouseup(function(t){
// left mouse button only
1==t.which&&(siteManager.enableBuckets(),$(window).unbind("mousemove"))}).mousedown(function(t){
// left mouse button only
var e=!0;1==t.which&&(siteManager.disableBuckets($(this)),"undefined"!=typeof frontEndProxy&&$(window).bind("mousemove",function(t){e&&(frontEndProxy.post({cmd:"autoScroll",y:t.pageY}),e=!1)})),timer=window.setInterval(function(){e=!0},100)})},updateBuckets:function(){$(".rcSortable").each(function(t){1==$(this).find("li.item").length?$(this).find("li.empty").removeClass("noShow"):$(this).find("li.empty").addClass("noShow")})},enableBuckets:function(){$(".rcSortable").each(function(t){$(this).sortable("enable"),$(this).parent().removeClass("disabled")})},disableBuckets:function(e){$(".rcSortable").each(function(t){
// ignore parent container
$(this).attr("id")!=e.parent().attr("id")&&(
// disable if not in allowed list
0<$(this).attr("data-accept").length&&-1==$(this).attr("data-accept").indexOf(e.attr("data-content-type"))&&($(this).sortable("disable"),$(this).parent().addClass("disabled")),
// disable if already in list
0<$(this).find('[data-contentid="'+e.attr("data-contentid")+'"]').length&&($(this).sortable("disable"),$(this).parent().addClass("disabled")))})},loadRelatedContent:function(a,n,e,t,i,o,r){void 0===o&&(o=!0);var s="./",c="muraAction=cArch.loadRelatedContent&compactDisplay=true&contentid="+a+"&siteid="+n+"&external="+o+"&isNew="+e+"&relatedcontentsetid="+r+"&"+t+"&cacheid="+Math.random(),d;$("#selectRelatedContent").html('<div class="load-inline"></div>'),$("#selectRelatedContent .load-inline").spin(spinnerArgs2),$.get("./?"+c,function(t){-1!=t.indexOf("mura-primary-login-token")&&(location.href="./"),$("#selectRelatedContent .load-inline").spin(!1),$("#selectRelatedContent").html(t),$("#draggableContainmentInternal").on("scroll",function(){$("#mura-rc-quickedit").hide()}),$(".rcDraggable li.item").draggable({connectToSortable:".rcSortable",helper:"clone",revert:"invalid",appendTo:"body",start:function(t,e){
// bind mouse events to clone
$("#mura-rc-quickedit").hide(),siteManager.bindMouse()},zIndex:100}).disableSelection(),setDatePickers(".mura-relatedContent-datepicker",dtLocale,dtCh),$("#aAdvancedSearch").click(function(t){t.preventDefault(),$("#rcAdvancedSearch").slideToggle("fast")}),0==e&&1==i&&($("#rcAdvancedSearch").show(),$("#aAdvancedSearch").addClass("active")),siteManager.bindMouse(),setCheckboxTrees(),siteManager.setupRCQuikEdit(),setToolTips(".tab-content"),$("#rcAdvancedSearch").find("ul.categories:not(.checkboxTrees)").css("margin-left","10px"),$(".mura-rc-quickoption").each(function(){siteManager.setupRCResultIcon($(this))}),$("#rcBtnSearch").click(function(t){t.preventDefault();var e=$("#rcAdvancedSearch").is(":visible"),i="#internalContent input";
// if doing an advanced search, then serialze all elements
e&&(i="#selectRelatedContent input, #selectRelatedContent select"),$("#mura-rc-quickedit").hide(),siteManager.loadRelatedContent(a,n,0,$(i).serialize(),e,o,r)})})},loadRelatedContentSets:function(e,t,i,a,n,o,r,s){var c="./";r=r||"[]",void 0===s&&(s=!0);var d="muraAction=cArch.loadSelectedRelatedContent&compactDisplay=true&contenthistid="+t+"&type="+i+"&subtype="+a+"&siteid="+n+"&relatedcontentsetid="+(o=o||"")+"&relateditems="+encodeURIComponent(r)+"&external="+s+"&cacheid="+Math.random(),l=$("#selectedRelatedContent");l.html('<div class="load-inline"></div>'),$("#selectedRelatedContent .load-inline").spin(spinnerArgs2),$.get("./?"+d,function(t){-1!=t.indexOf("mura-primary-login-token")&&(location.href="./"),$("#selectedRelatedContent .load-inline").spin(!1),l.html(t),siteManager.setupRCSortable(e,s,o)})},setupRCResultIcon:function(t){$("#selectedRelatedContent").find('li[data-contentid="'+t.val()+'"]').length?t.find("i").attr("class","mi-check"):t.find("i").attr("class","mi-plus-circle")},setupRCQuikEdit:function(){$(".mura-rc-quickoption").each(function(){$(this).unbind("on").on("click",function(){var a=$(this).val(),n=$("#selectRelatedContent").find('li[data-contentid="'+a+'"]');$("#mura-rc-quickedit").show(),$("#mura-rc-quickedit").offset({top:$(this).offset().top}),$(".mura-rc-quickassign").each(function(){var t=this,e=$("#rcSortable-"+$(t).val()),i=function(){return e.find('li[data-contentid="'+a+'"]').length};$("#mura-rc-quickedit").show(),$(t).attr("disabled",!1),
// ignore parent container
e.attr("id")!=n.parent().attr("id")&&0<e.attr("data-accept").length&&-1==e.attr("data-accept").indexOf(n.attr("data-content-type"))&&$(t).attr("disabled",!0),$(this).unbind("change"),$(this).prop("checked",i()),$(this).on("change",function(){$(this).prop("checked")?(n.clone().appendTo($("#rcSortable-"+$(t).val())),$("#rcSortable-"+$(t).val()).find(".mura-rc-quickoption").remove(),$("#rcSortable-"+$(t).val()).find('li[data-contentid="'+a+'"]').append('<a class="delete"></a>')):$("#rcSortable-"+$(t).val()).find('li[data-contentid="'+a+'"]').remove(),
//alert($('#selectRelatedContent button[value="'+ $contentid + '"]').length)
//alert($('#selectedRelatedContent').find('li[data-contentid="'+ $contentid  + '"]').length)
siteManager.setupRCResultIcon($('#selectRelatedContent button[value="'+a+'"]')),siteManager.updateBuckets(),siteManager.bindDelete(),siteManager.bindMouse(),siteManager.updateRCForm()})})})})},setupRCSortable:function(t,e,i){void 0===e&&(e=!0),$(".rcSortable").sortable({connectWith:".rcSortable",revert:!0,update:function(t,e){siteManager.updateBuckets(),0==e.item.find("a.delete").length&&e.item.append('<a class="delete"></a>'),e.item.attr("style",""),siteManager.bindDelete(),siteManager.bindMouse(),siteManager.setDirtyRelatedContent(),siteManager.updateRCForm(),siteManager.setupRCResultIcon($('#selectRelatedContent button[value="'+e.item.attr("data-contentid")+'"]'))},cancel:"li.empty"}).disableSelection(),siteManager.loadRelatedContent(t,siteid,1,"",!1,e,i),siteManager.bindDelete(),siteManager.bindMouse(),siteManager.updateRCForm(),siteManager.setupRCQuikEdit()},updateRCForm:function(){var i=new Array;$(".rcSortable").each(function(){var t=new Array,e=new Object;$(this).find(".mura-rc-quickoption").remove(),$(this).find("li.item:not(.empty)").each(function(){void 0===$(this).attr("data-url")?t.push($(this).attr("data-contentid")):t.push({title:$(this).attr("data-title"),url:$(this).attr("data-url"),contentid:$(this).attr("data-contentid")})}),e.relatedcontentsetid=$(this).attr("data-relatedcontentsetid"),e.items=t,i.push(e)}),$("#relatedContentSetData").val(JSON.stringify(i))},setDirtyRelatedContent:function(){this.dirtyRelatedContent=!0},form_is_modified:function(t){for(var e=0;e<t.elements.length;e++){var i=t.elements[e],a=i.type;if("checkbox"==a||"radio"==a){if(i.checked!=i.defaultChecked)
//alert(type + ":" + element.name)
return!0}else if(("hidden"==a||"password"==a||"text"==a||"textarea"==a)&&i.value!=i.defaultValue&&"sdContent"!=i.name)
//alert(type + ":" + element.name)
return!0;
/*
	        else if (type == "select-one" || type == "select-multiple")
	        {
	            for (var j = 0; j < element.options.length; j++)
	            {
	                if (element.options[j].selected !=
	                    element.options[j].defaultSelected)
	                {
	                    return true;
	                }
	            }
	        }
	        */}if("undefined"!=typeof FCKeditorAPI){if(FCKeditorAPI.GetInstance("body")&&FCKeditorAPI.GetInstance("body").IsDirty())return!0;if(FCKeditorAPI.GetInstance("summary")&&FCKeditorAPI.GetInstance("summary").IsDirty())return!0;if(this.dirtyRelatedContent)return!0}else if("undefined"!=typeof CKEDITOR&&void 0!==CKEDITOR.instances.body){var n;if(CKEDITOR.instances.body.checkDirty())return!0}return!1},copyThis:function(t,e,i){var a="./",n="muraAction=cArch.saveCopyInfo&siteid="+t+"&contentid="+e+"&moduleid="+siteManager.currentModuleID+"&copyAll="+i+"&cacheid="+Math.random();$.get("./?"+n),this.copyContentID=e,this.copySiteID=t,this.copyModuleID=siteManager.currentModuleID,this.copyAll=i,this.hideMenu("newContentMenu")},pasteThis:function(e){if(this.copyModuleID!=this.currentModuleID)alert("Pasting between modules is not supported.");else{var t="./",i="muraAction=cArch.copy&compactDisplay=true&siteid="+this.copySiteID+"&copyAll="+this.copyAll+"&contentid="+this.copyContentID+"&parentid="+e+"&cacheid="+Math.random(),a;$("#newPasteLink").css("background","url(assets/images/ajax-loader.gif) no-repeat 1px 5px;"),this.reloadURL=$("#newZoomLink").attr("href"),actionModal(function(){$.get("./?"+i,function(t){$("#action-modal").remove(),siteManager.loadSiteManagerInTab(function(){siteManager.loadSiteManager(siteManager.copySiteID,e,siteManager.currentModuleID,"","","",1)})})})}},reloadPage:function(){""==reloadURL?window.location.reload():location.href=this.reloadURL},loadExtendedAttributes:function(t,e,i,a,n,o,r){var s="./",c="muraAction=cArch.loadExtendedAttributes&contentHistID="+e+"&type="+i+"&subType="+a+"&siteID="+n+"&tablist="+siteManager.tablist+"&cacheid="+Math.random();return siteID=n,context=o,themeAssetPath=r,
//location.href=url + "?" + pars;
$(".extendset-container").each(function(){""!=$(this).html()&&($(this).html('<div class="load-inline"></div>'),$(this).find(".load-inline").spin(spinnerArgs2))}),siteManager.loadRelatedContentSets(t,e,i,a,n),$.ajax({url:"./?"+c,dataType:"text",success:function(t){siteManager.setExtendedAttributes(t)}}),!1},setExtendedAttributes:function(data){
//alert(data);
var r=eval("("+data+")");$.each(r,function(t,e){
//alert(name + ": " + value);
$("#extendset-container-"+t+" .load-inline").spin(!1),$("#extendset-container-"+t).html(e)}),""==r.default?$("#tabExtendedAttributesLI").addClass("hide"):$("#tabExtendedAttributesLI").removeClass("hide"),r.hasconfigurator?$("#tabListDisplayOptionsLI").removeClass("hide"):$("#tabListDisplayOptionsLI").addClass("hide"),r.hassummary?"undefined"!=typeof showSummaryEditor&&showSummaryEditor():"undefined"!=typeof hideSummaryEditor&&hideSummaryEditor(),r.hasbody?"undefined"!=typeof showBodyEditor&&showBodyEditor():"undefined"!=typeof hideBodyEditor&&hideBodyEditor(),r.hasassocfile?$("#assocFileContainer").show():($("#assocFileContainer").hide(),$("input[name='newfile']").val("")),this.checkExtendSetTargeting(),setHTMLEditors(),setDatePickers(".tab-content .datepicker",dtLocale),setColorPickers(".tab-content .colorpicker"),setFinders(".tab-content .mura-ckfinder"),setToolTips(".tab-content"),setFileSelectors(),$(window).trigger("resize")},checkExtendSetTargeting:function(){var t=$(".extendset"),e=!1,i=!1,a=!0;if(t.length){for(var n=0;n<t.length;n++){var o=t[n];if(null!=o.getAttribute("categoryid")&&""!=o.getAttribute("categoryid")){if(!i){var r=$("categoryContainer").getElementsByTagName("select");i=!0}for(var s=0;s<r.length;s++){var c=r[s],d=r[s].getAttribute("categoryid"),l=o.getAttribute("categoryid");!e&&null!=d&&-1<l.indexOf(d)&&(e=!0,membership=c.value)}e&&""!=membership?(this.setFormElementsDisplay(o,""),o.style.display="",a=!1):(this.setFormElementsDisplay(o,"none"),o.style.display="none")}else this.setFormElementsDisplay(o,""),o.style.display="",a=!1;e=!1}a?($("#extendMessage").show(),$("#extendDL").hide()):($("#extendMessage").hide(),$("#extendDL").show())}},resetExtendedAttributes:function(t,e,i,a,n,o){var r=i.split("^");this.loadExtendedAttributes(t,e,r[0],r[1],a,n,o),
//alert(dataArray[1]);
document.contentForm.type.value=r[0],document.contentForm.subtype.value=r[1]},setFormElementsDisplay:function(t,e){var i=t.getElementsByTagName("input");
//alert(inputs.length);
if(i.length)for(var a=0;a<i.length;a++)i[a].style.display=e;
//alert(inputs[i].style.display);
if((i=t.getElementsByTagName("textarea")).length)for(var a=0;a<i.length;a++)i[a].style.display=e;if((i=t.getElementsByTagName("select")).length)for(var a=0;a<i.length;a++)i[a].style.display=e},loadCategoryFeatureStartStop:function(e,t,i){var a=$("#"+e);if(10<a.html().length)a.toggle();else if(1==t){var n="./",o,r="muraAction=cArch.loadCategoryFeatureStartStop&id="+e.replace(/editDates/,"")+"&siteID="+i+"&cacheid="+Math.random();a.show(),$.get("./?"+r,function(t){$("#"+e).html(t),setDatePickers("#"+e+" .datepicker",dtLocale),setToolTips("#"+e)})}},activeQuickEdit:!1,loadSiteManager:function(siteid,topid,moduleid,sortby,sortdirection,ptype,startrow){var url="./",pars="muraAction=cArch.loadSiteManager&siteid="+siteid+"&topid="+topid+"&moduleid="+moduleid+"&sortby="+sortby+"&sortdirection="+sortdirection+"&ptype="+ptype+"&startrow="+startrow+"&cacheid="+Math.random();$("#newContentMenu").addClass("hide"),
//$('#viewTabs a[href="#tabArchitectural"]').tab('show');
//location.href=url + "?" + pars;
siteManager.currentModuleID=moduleid;var d=$("#gridContainer");return this.activeQuickEdit||(d.html('<div class="load-inline"></div>').show(),$("#gridContainer .load-inline").spin(spinnerArgs2)),$(".site-manager-mod").removeClass("active"),$('.site-manager-mod[data-moduleid="'+moduleid+'"]').addClass("active"),"00000000000000000000000000000000000"==moduleid?$("#gridContainer").addClass("site-tree"):$("#gridContainer").removeClass("site-tree"),
// return false;
$.ajax({url:url+"?"+pars,dataType:"text",success:function(data){try{var r=eval("("+data+")");siteManager.activeQuickEdit||(d.hide(),$("#gridContainer .load-inline").spin(!1)),d.html(r.html),$("#newContentMenu").addClass("hide"),stripe("stripe"),siteManager.initQuickEdits(),initDraftPrompt(),setToolTips("#gridContainer"),"editor"==r.perm.toLowerCase()&&"orderno"==r.sortby.toLowerCase()&&($("#sortableKids").sortable({helper:"clone",stop:function(t,e){stripe("stripe"),siteManager.setAsSorted(),$(e.item).removeClass("ui-draggable-dragging")},start:function(t,e){$(e.item).addClass("ui-draggable-dragging")}}),$("#sortableKids").disableSelection())}catch(t){-1!=data.indexOf("mura-primary-login-token")&&(location.href="./"),d.html(data)}siteManager.activeQuickEdit||d.hide().animate({opacity:"show"},1e3),siteManager.activeQuickEdit=!1},error:function(t,e,i){console.log("error "+e)}}),!1},sectionLoading:!1,loadSiteFlatByFilter:function(){var t=$("#contentTypeFilter").val();if(""!=t){var e=t.split("^");flatViewArgs.type=e[0],flatViewArgs.subtype=e[1]}else flatViewArgs.type="",flatViewArgs.subtype="";var i=[];$(".categories :checked").each(function(){i.push($(this).val())}),flatViewArgs.categoryid=i.toString();var a=[];if($("input[name='tags']").each(function(){a.push($(this).val())}),flatViewArgs.tags=a.toString(),customtaggroups.length)for(var n=0;n<customtaggroups.length;n++)a=[],$("input[name='"+customtaggroups[n]+"tags']").each(function(){$(this).val().length&&a.push($(this).val())}),flatViewArgs[customtaggroups[n]+"tags"]=a.toString();flatViewArgs.keywords=$("#contentKeywords").val(),flatViewArgs.page=1,flatViewArgs.filtered=!0,this.loadSiteFlat(flatViewArgs)},loadSiteManagerInTab:function(t){
//document.getElementById("newContentMenu").style.visibility="hidden";
return archViewLoaded=!0,window.scrollTo(0,0),$("#gridContainer").html('<div class="load-inline"></div>'),$('#viewTabs a[href="#tabArchitectural"]').tab("show"),t(),!1},loadSiteFlat:function(args){var url="./",pars="muraAction=cArch.loadSiteFlat&cacheid="+Math.random(),d=$("#flatViewContainer");return d.html('<div class="load-inline"></div>'),$("#flatViewContainer .load-inline").spin(spinnerArgs2),$("#newContentMenu").addClass("hide"),$.post(url+"?"+pars,args,function(data){if(-1!=data.indexOf("mura-primary-login-token")&&(location.href="./"),$("#flatViewContainer .load-inline").spin(!1),d.html(data),stripe("stripe"),setCheckboxTrees(),setToolTips(".mura-table-grid"),$.ajax({url:"?muraAction=carch.loadtagarray&siteid="+siteid,dataType:"text",success:function(data){var tagArray=[];if(data)var tagArray=eval("("+data+")");$("#tags").tagSelector(tagArray,"tags")}}),customtaggroups.length)for(var g=0;g<customtaggroups.length;g++)window[customtaggroups[g]]?$("#"+customtaggroups[g]+"tags").tagSelector(window[customtaggroups[g]],customtaggroups[g]+"tags"):$.ajax({url:"?muraAction=carch.loadtagarray&siteid="+siteid+"&taggroup="+customtaggroups[g],context:{taggroup:customtaggroups[g]},dataType:"text",success:function(data){window[this.taggroup]=eval("("+data+")"),$("#"+this.taggroup+"tags").tagSelector(window[this.taggroup],this.taggroup+"tags")}});$(".navSort a").click(function(t){t.preventDefault(),$(".sortNav .active").toggleClass("active"),$(this).toggleClass("active");var e=$(this).attr("data-sortby");if(e==flatViewArgs.sortby)"asc"==flatViewArgs.sortdirection?flatViewArgs.sortdirection="desc":flatViewArgs.sortdirection="asc";else switch(flatViewArgs.sortby=e,flatViewArgs.sortby){case"menutitle":flatViewArgs.sortdirection="asc";break;case"created":case"lastupdate":case"releasedate":flatViewArgs.sortdirection="desc"}flatViewArgs.page=1,siteManager.loadSiteFlat(flatViewArgs)}),$("#navReports a").click(function(t){t.preventDefault(),$(".navReports .active").toggleClass("active"),$(this).toggleClass("active");var e=$(this).attr("data-report");"mylockedfiles"!=flatViewArgs.report&&"lockedfiles"!=flatViewArgs.report||"mylockedfiles"==e||"lockedfiles"==e||(flatViewArgs.type=""),flatViewArgs.report=e,"mylockedfiles"!=flatViewArgs.report&&"lockedfiles"!=flatViewArgs.report||(flatViewArgs.type="File"),flatViewArgs.page=1,siteManager.loadSiteFlat(flatViewArgs)}),$("#tabFlat .moreResults a").click(function(t){t.preventDefault(),$("#tabFlat .moreResults a").toggleClass("active"),$(this).toggleClass("active"),flatViewArgs.page=$(this).attr("data-page"),siteManager.loadSiteFlat(flatViewArgs)}),initDraftPrompt(),d.hide().animate({opacity:"show"},1e3)}),!1},loadSiteSection:function(node,startrow){var clearTimer=function(){$("#mura-section-loading").spin(!1),$("#mura-section-loading").remove(),$("#mura-grid-loader").remove(),clearTimeout(startTimer)};if(clearTimer(),!this.sectionLoading){this.sectionLoading=!0;var url="./index.cfm",pars="muraAction=cArch.loadSiteSection&siteid="+node.attr("data-siteid")+"&contentID="+node.attr("data-contentid")+"&moduleid="+node.attr("data-moduleid")+"&sortby="+node.attr("data-sortby")+"&sortdirection="+node.attr("data-sortdirection")+"&ptype="+node.attr("data-type")+"&startrow="+startrow+"&cacheid="+Math.random(),icon=node.find("span:first");if(icon.hasClass("hasChildren closed")){var startTimer=setTimeout(function(){
//if(siteManager.sectionLoading){
node.prepend('<div id="mura-section-loading" class="spinner-wrap"></div>'),$(".mura-grid").prepend('<div id="mura-grid-loader"></div>'),$("#mura-section-loading").spin(spinnerArgs3)},1e3);icon.removeClass("hasChildren closed"),icon.addClass("hasChildren open"),
//d.find(".loadProgress").show();
$.ajax({url:url+"?"+pars,dataType:"text",success:function(data){try{var r=eval("("+data+")");node.find(".mura-section:first").remove(),node.append(r.html),$("#newContentMenu").addClass("hide"),stripe("stripe"),initDraftPrompt(),siteManager.initQuickEdits(),
//The fadeIn in ie8 causes a rendering issue
document.all&&document.querySelector&&!document.addEventListener||node.find(".mura-section:first").hide().fadeIn("slow")}catch(t){-1!=data.indexOf("mura-primary-login-token")&&(location.href="./"),node.append(data)}clearTimer(),siteManager.sectionLoading=!1}})}else icon.removeClass("hasChildren open"),icon.addClass("hasChildren closed"),$.get(url+"?"+pars),node.find(".mura-section:first").fadeOut("fast",function(){node.find(".mura-section:first").remove(),stripe("stripe"),$("#newContentMenu").addClass("hide"),siteManager.sectionLoading=!1})}return!1},refreshSiteSection:function(node,startrow){if(!this.sectionLoading){this.sectionLoading=!0;var url="./",pars="muraAction=cArch.refreshSiteSection&siteid="+node.attr("data-siteid")+"&contentID="+node.attr("data-contentid")+"&moduleid="+node.attr("data-moduleid")+"&sortby="+node.attr("data-sortby")+"&sortdirection="+node.attr("data-sortdirection")+"&ptype="+node.attr("data-type")+"&startrow="+startrow+"&cacheid="+Math.random();$.ajax({url:url+"?"+pars,dataType:"text",success:function(data){try{var r=eval("("+data+")");
//d.find(".loadProgress").remove();
node.find(".mura-section:first").remove(),node.append(r.html),$("#newContentMenu").addClass("hide"),stripe("stripe"),initDraftPrompt(),siteManager.initQuickEdits()}catch(t){-1!=data.indexOf("mura-primary-login-token")&&(location.href="./"),node.append(data)}siteManager.activeQuickEdit=!1,siteManager.sectionLoading=!1}})}return!1},setAsSorted:function(){$("#sorted").val("true"),$("#sitemgr-reorder").fadeIn()},initQuickEdits:function(){$(".mura-quickEditItem").click(function(t){if(t.preventDefault(),$(this).data("clicked",!$(this).data("clicked")),$(this).data("clicked")){if(!this.activeQuickEdit){var i=$(this).attr("data-attribute"),e=$(this).parents("li:first"),a="./",n="muraAction=cArch.loadQuickEdit&siteid="+siteid+"&contentID="+e.attr("data-contentid")+"&attribute="+i+"&cacheid="+Math.random();
//location.href='?' + pars;
//images/icons/template_24x24.png
$("#mura-quickEditor").remove(),$("#selected").attr("id",""),$("#selectedIcon").attr("id","").attr("src","assets/images/icons/template_24x24.png"),$(this).parent().prepend(quickEditTmpl);var o=$("#mura-quickEditor").parents("dd:first");o.attr("id","selected"),$.get("./?"+n,function(t){if(-1!=t.indexOf("mura-primary-login-token")&&(location.href="./"),$("#mura-quickEditor").html(t),$("#mura-quickEditor").find("input, select").bind("mousedown.ui-disableSelection selectstart.ui-disableSelection",function(t){t.stopImmediatePropagation()}),setDatePickers(".mura-quickEdit-datepicker",dtLocale,dtCh),setToolTips(".mura-quickEdit-datepicker"),setDatePickers("#mura-datepicker-displayStart",dtLocale,dtCh),setDatePickers("#mura-datepicker-displayStop",dtLocale,dtCh),setDatePickers("#displayIntervalEndOn",dtLocale,dtCh),$("#hasDraftsMessage").length&&o.addClass("hasDraft"),"template"==i){var e=o.find("img:first");e.length&&e.attr("id","selectedIcon").attr("src","assets/images/icons/template_24x24-on.png")}})}}else siteManager.closeQuickEdit()});
/*
		$(".mura-quickEditItem").toggle(

		function(event) {

			event.preventDefault();
			if(!this.activeQuickEdit) {

				var attribute = $(this).attr("data-attribute");
				var node = $(this).parents("li:first");
				var url = './';
				var pars = 'muraAction=cArch.loadQuickEdit&siteid=' + siteid + '&contentID=' + node.attr("data-contentid") + '&attribute=' + attribute + '&cacheid=' + Math.random();

				//location.href='?' + pars;
				//images/icons/template_24x24.png
				$("#mura-quickEditor").remove();
				$("#selected").attr("id", "");
				$('#selectedIcon').attr("id", "").attr("src", "assets/images/icons/template_24x24.png");
				$(this).parent().prepend(quickEditTmpl);

				var qe = $("#mura-quickEditor")
				var dd = qe.parents("dd:first");

				dd.attr("id", "selected");

				$.get(url + "?" + pars, function(data) {
					if(data.indexOf('mura-primary-login-token') != -1) {
						location.href = './';
					}
					$("#mura-quickEditor").html(data);

					setDatePickers(".mura-quickEdit-datepicker", dtLocale, dtCh);
					setToolTips(".mura-quickEdit-datepicker");
					if($("#hasDraftsMessage").length) {
						dd.addClass("hasDraft");
					}

					if(attribute == 'template') {
						var img = dd.find("img:first");
						if(img.length) {
							img.attr("id", "selectedIcon").attr("src", "assets/images/icons/template_24x24-on.png")
						}
					}

				});
			}
		}, function(event) {
			event.preventDefault();
			siteManager.closeQuickEdit();
		});
*/},saveQuickEdit:function(){this.activeQuickEdit=!0;var t=$("#mura-quickEditor").parent().find(".mura-quickEditItem:first").attr("data-attribute"),a=$("#mura-quickEditor").parents("li:first"),e="./",i={muraAction:"cArch.saveQuickEdit",siteID:siteID,contentID:a.attr("data-contentid"),attribute:t};if("isnav"==t)var n={isnav:$("#mura-quickEdit-isnav").val()};else if("inheritObjects"==t)var n={inheritObjects:$("#mura-quickEdit-inheritobjects").val()};else if("template"==t)var n={template:$("#mura-quickEdit-template").val(),childTemplate:$("#mura-quickEdit-childtemplate").val()};else if("display"==t)
/*
			var attributeParams = {
				'display': $("#mura-quickEdit-display").val(),
				'displayStop': $("#mura-quickEdit-displayStop").val(),
				'stopHour': $("#mura-quickEdit-stopHour").val(),
				'stopMinute': $("#mura-quickEdit-stopMinute").val(),
				'stopDayPart': ($("#mura-quickEdit-stopDayPart").length) ? $("#mura-quickEdit-stopDayPart").val(): '',
				'displayStart': $("#mura-quickEdit-displayStart").val(),
				'startHour': $("#mura-quickEdit-startHour").val(),
				'startMinute': $("#mura-quickEdit-startMinute").val(),
				'startDayPart': ($("#mura-quickEdit-startpDayPart").length) ? $("#mura-quickEdit-startDayPart").val(): ''
			}
			*/
if($("#displayInterval").length)var n={display:$("#mura-display").val(),displayStop:$("#mura-displayStop").val(),displayStart:$("#mura-displayStart").val(),displayInterval:$("#displayInterval").val()};else var n={display:$("#mura-quickEdit-display").val(),displayStop:$("#mura-quickEdit-displayStop").val(),displayStart:$("#mura-quickEdit-displayStart").val()};var o=$.extend({},i,n);$("#mura-quickEditor").html('<img class="loader" src="assets/images/ajax-loader-alt.gif" />'),$.ajax({type:"POST",url:"./index.cfm?"+a.attr("data-csrf"),data:o,success:function(t){-1!=t.indexOf("mura-primary-login-token")&&(location.href="./");var e=a.parents("li:first");if(e.parents("li:first").length)siteManager.refreshSiteSection(e,1);else{var i=$("#top-node").parents("li:first");siteManager.loadSiteManager(i.attr("data-siteid"),i.attr("data-contentid"),i.attr("data-moduleid"),i.attr("data-sortby"),i.attr("data-sortdirection"),i.attr("data-type"),1)}},error:function(t,e,i){alert(t.responseText)},dataType:"text"})},closeQuickEdit:function(){$("#selected").attr("id",""),$("#selectedIcon").attr("id","").attr("src","assets/images/icons/template_24x24.png"),$(".mura-quickEdit").remove()},initCategoryAssignments:function(){$(".mura-quickEditItem").click(function(t){t.preventDefault();
//$(this).data('clicked',!$(this).data('clicked'));
/*
		    if ($(this).data('clicked'))
		        {
				*/
var e=$(this).parents("li:first"),i=e.attr("data-cattrim"),a={muraAction:"cArch.loadCategoryAssignment",cattrim:e.attr("data-cattrim"),siteID:e.attr("data-siteid"),categoryID:e.attr("data-categoryid"),categoryAssignment:$("#categoryAssign"+i).val(),featureStart:"",startHour:"",startMinute:"",startDayPart:"",featureStop:"",stopHour:"",stopMinute:"",stopDayPart:""};"2"==a.categoryAssignment&&$.extend(a,{featureStart:$("#featureStart"+i).val(),startHour:$("#startHour"+i).val(),startMinute:$("#startMinute"+i).val(),startDayPart:$("#startDayPart"+i).val(),featureStop:$("#featureStop"+i).val(),stopHour:$("#stopHour"+i).val(),stopMinute:$("#stopMinute"+i).val(),stopDayPart:$("#stopDayPart"+i).val()}),$("#mura-quickEditor").remove(),$("#selected").attr("id",""),$("#selectedIcon").attr("id","").attr("src","assets/images/icons/template_24x24.png"),$(this).parent().prepend(quickEditTmpl);var n=$("#mura-quickEditor").parents("dd:first");$(n).attr("id","selected"),$.ajax({type:"POST",url:"./index.cfm",data:a,success:function(t){-1!=t.indexOf("mura-primary-login-token")&&(location.href="./"),$("#mura-quickEditor").html(t),setDatePickers(".mura-quickEdit-datepicker",dtLocale,dtCh),setToolTips(".mura-quickEdit-datepicker")},error:function(t,e,i){alert(i)},dataType:"text"})})},saveCategoryAssignment:function(){var e=$("#mura-quickEdit-cattrim").val(),t={muraAction:"cArch.loadCategoryFeatureStartStop",cattrim:e,categoryAssignment:$("#mura-quickEdit-display").val(),featureStart:$("#mura-quickEdit-featureStart").val(),startHour:$("#mura-quickEdit-startHour").val(),startMinute:$("#mura-quickEdit-startMinute").val(),startDayPart:$("#mura-quickEdit-startDayPart").length?$("#mura-quickEdit-startDayPart").val():"",featureStop:$("#mura-quickEdit-featureStop").val(),stopHour:$("#mura-quickEdit-stopHour").val(),stopMinute:$("#mura-quickEdit-stopMinute").val(),stopDayPart:$("#mura-quickEdit-stopDayPart").length?$("#mura-quickEdit-stopDayPart").val():"",siteid:siteid};$("#mura-quickEditor").html('<img class="loader" src="assets/images/ajax-loader-alt.gif" />'),$.ajax({type:"POST",url:"./index.cfm",data:t,success:function(t){-1!=t.indexOf("mura-primary-login-token")&&(location.href="./"),$("#categoryLabelContainer"+e).html(t),siteManager.closeCategoryAssignment(),setToolTips(".mura-quickEdit-datepicker"),siteManager.initCategoryAssignments()},error:function(t,e,i){alert(i)},dataType:"text"})},closeCategoryAssignment:function(){$("#selected").attr("id",""),$(".mura-quickEdit").remove()},availableObjectTemplate:"",availalbeObjectParams:{},availableObject:{},availableObjectValidate:function(){return!0},getDisplayObjectConfig:function(t){var e,i,a=$("#selectedObjects"+t).val().toString().split("~"),n={};return n.object=a[0],n.name=a[1],n.objectid=a[2],3<a.length&&(n.params=a[3]),n.regionid=t,n.context=context,n.siteid=siteid,n.contentid=contentid,n.contenthistid=contenthistid,n.parentid=parentid,n},addDisplayObject:function(objectToAdd,regionid,configure,isUpdate){var tmpObject="",tmpValue="",tmpText="";
//If it's not a js object then it must be an id of a form input or select
if(isUpdate=isUpdate||!1,"string"==typeof objectToAdd){
// return error if the id does not exist.
if(null==document.getElementById(objectToAdd))return alertDialog("Please select a display object."),!1;if("select"==document.getElementById(objectToAdd).tagName.toLowerCase()){if(-1==document.getElementById(objectToAdd).selectedIndex)return alertDialog("Please select a display object."),!1;
//alert("Please select a display object."); return false;}
var addIndex=document.getElementById(objectToAdd).selectedIndex;if(addIndex<0)return!1;var addoption=document.getElementById(objectToAdd).options[addIndex];tmpText=addoption.text,tmpValue=addoption.value}else if("input"==document.getElementById(objectToAdd).tagName.toLowerCase()){var addoption=document.getElementById(objectToAdd);tmpValue=addoption.value}else
//If it's not a select box then the value must be json object.
addoption=document.getElementById(objectToAdd);try{tmpObject=eval("("+addoption.value+")")}catch(t){tmpObject=addoption.value}}else
//If it's not a select box then the value must be json object.
tmpObject=objectToAdd;
//if the tmpValue evaluated into a js object pull out it's values
var checkSelection=!1;if("object"==typeof tmpObject){if(
//object^name^objectID^params
tmpObject.regionid=regionid,tmpObject.context=context,tmpObject.siteid=siteid,tmpObject.contentid=contentid,tmpObject.contenthistid=contenthistid,tmpObject.parentid=parentid,"feed"==tmpObject.object){if(configure&&(
//alert(JSON.stringify(tmpObject));
tmpObject.regionid=regionid,this.initFeedConfigurator(tmpObject)))return!1;checkSelection=!0}if("feed_slideshow"==tmpObject.object){if(configure)return tmpObject.regionid=regionid,this.initSlideShowConfigurator(tmpObject),!1;checkSelection=!0}if("tag_cloud"==tmpObject.object&&siteManager.customtaggroups.length){if(configure)return tmpObject.regionid=regionid,this.initTagCloudConfigurator(tmpObject),!1;checkSelection=!0}if(siteManager.allowopenfeeds&&"category_summary"==tmpObject.object){if(configure)return tmpObject.regionid=regionid,this.initCategorySummaryConfigurator(tmpObject),!1;checkSelection=!0}if("related_content"==tmpObject.object||"related_section_content"==tmpObject.object){if(configure)return tmpObject.regionid=regionid,this.initRelatedContentConfigurator(tmpObject),!1;checkSelection=!0}if("site_map"==tmpObject.object){if(configure)return tmpObject.regionid=regionid,this.initSiteMapConfigurator(tmpObject),!1;checkSelection=!0}if("plugin"==tmpObject.object){if(configure)if(tmpObject.objectid&&"none"!=tmpObject.objectid.toLowerCase()){var configurator=this.getPluginConfigurator(tmpObject.objectid);if(""!=configurator)return window[configurator](tmpObject),!1;if(siteManager.layoutmanager)return this.initGenericConfigurator(tmpObject),!1}else siteManager.layoutmanager&&this.initGenericConfigurator(tmpObject);checkSelection=!0}if(siteManager.layoutmanager&&(configure&&(siteManager.objectHasConfigurator(tmpObject)?siteManager.configuratorMap[tmpObject.object].initConfigurator(tmpObject):this.initGenericConfigurator(tmpObject)),checkSelection=!0),tmpValue=tmpObject.object,tmpValue=tmpValue+"~"+tmpObject.name,tmpValue=tmpValue+"~"+tmpObject.objectid,"string"==typeof tmpObject.params?tmpValue=tmpValue+"~"+tmpObject.params:"object"==typeof tmpObject.params&&(tmpValue=tmpValue+"~"+JSON.stringify(tmpObject.params)),!isUpdate&&checkSelection&&-1!=document.getElementById("selectedObjects"+regionid).selectedIndex){var currentSelection=this.getDisplayObjectConfig(regionid);currentSelection&&(currentSelection.objectid!=tmpObject.objectid&&currentSelection.objectid!=tmpObject.originid||(isUpdate=!0))}tmpText=tmpObject.name}if(""==tmpValue)return alertDialog("Please select a display object."),!1;
//get reference to the select where it will go.
var selectedObjects=document.getElementById("selectedObjects"+regionid);
//double check that it's not already there
if(selectedObjects.options.length)for(var i=0;i<selectedObjects.options.length;i++)if(selectedObjects.options[i].value==tmpValue)return selectedObjects.selectedIndex=i,!1;
// add it.
if(isUpdate&&-1!=selectedObjects.selectedIndex)myoption=selectedObjects.options[selectedObjects.selectedIndex],myoption.text=tmpText,myoption.value=tmpValue;else{var myoption=document.createElement("option");selectedObjects.appendChild(myoption),myoption.text=tmpText,myoption.value=tmpValue,myoption.selected="selected"}return this.updateDisplayObjectList(regionid),!0},initTagCloudConfigurator:function(t){return this.initConfigurator(t,{url:"./",pars:"muraAction=cArch.loadclassconfigurator&compactDisplay=true&siteid="+siteid+"&classid=tag_cloud&contentid="+contentid+"&parentid="+parentid+"&contenthistid="+contenthistid+"&regionid="+t.regionid+"&objectid="+t.objectid+"&cacheid="+Math.random(),title:tagCloudConfiguratorTitle}),!0},initSiteMapConfigurator:function(t){return this.initConfigurator(t,{url:"./",pars:"muraAction=cArch.loadclassconfigurator&compactDisplay=true&siteid="+siteid+"&classid=site_map&contentid="+contentid+"&parentid="+parentid+"&contenthistid="+contenthistid+"&regionid="+t.regionid+"&objectid="+t.objectid+"&cacheid="+Math.random(),title:siteMapConfiguratorTitle}),!0},initCategorySummaryConfigurator:function(t){return(void 0===t.object||"category_summary"==t.object)&&(this.initConfigurator(t,{url:"./",pars:"muraAction=cArch.loadclassconfigurator&compactDisplay=true&siteid="+siteid+"&classid=category_summary&contentid="+contentid+"&parentid="+parentid+"&contenthistid="+contenthistid+"&regionid="+t.regionid+"&objectid="+t.objectid+"&cacheid="+Math.random(),title:categorySummaryConfiguratorTitle}),!0)},initFeedConfigurator:function(t){
//location.href=url + "?" + pars;
/*
		if(typeof(data.object) !='undefined'){
			if(data.object !='feed'){
				return false;
			}
		}
		*/
return this.initConfigurator(t,{url:"./",pars:"muraAction=cArch.loadclassconfigurator&compactDisplay=true&siteid="+siteid+"&classid=feed&contentid="+contentid+"&parentid="+parentid+"&contenthistid="+contenthistid+"&regionid="+t.regionid+"&feedid="+t.objectid+"&cacheid="+Math.random(),title:"Loading...",init:function(t,e){
//alert(JSON.stringify(data));
"remote"==t.type.toLowerCase()?"frontEnd"==siteManager.configuratorMode?$("#configuratorHeader").html(remoteFeedConfiguratorTitle):$("#configuratorContainer").dialog("option","title",remoteFeedConfiguratorTitle):"frontEnd"==siteManager.configuratorMode?$("#configuratorHeader").html(localIndexConfiguratorTitle):$("#configuratorContainer").dialog("option","title",localIndexConfiguratorTitle),$("#availableListSort").length&&$("#availableListSort, #displayListSort").sortable({connectWith:".displayListSortOptions",update:function(t){t.stopPropagation(),$("#displayList").val(""),$("#displayListSort > li").each(function(){var t=$("#displayList").val();""!=t?$("#displayList").val(t+","+$.trim($(this).html())):$("#displayList").val($.trim($(this).html()))}),siteManager.layoutmanager?siteManager.updateObjectPreview():siteManager.updateAvailableObject()}}).disableSelection()}}),!0},initFolderConfigurator:function(t){
//location.href=url + "?" + pars;
/*
		if(typeof(data.object) !='undefined'){
			if(data.object !='feed'){
				return false;
			}
		}
		*/
return this.initConfigurator(t,{url:"./",pars:"muraAction=cArch.loadclassconfigurator&compactDisplay=true&siteid="+siteid+"&classid=folder&contentid="+contentid+"&parentid="+parentid+"&contenthistid="+contenthistid+"&regionid="+t.regionid+"&feedid="+t.objectid+"&cacheid="+Math.random(),title:"Loading...",init:function(t,e){
//alert(JSON.stringify(data));
folderConfiguratorTitle="Folder","frontEnd"==siteManager.configuratorMode?$("#configuratorHeader").html(folderConfiguratorTitle):$("#configuratorContainer").dialog("option","title",folderConfiguratorTitle),$("#availableListSort").length&&$("#availableListSort, #displayListSort").sortable({connectWith:".displayListSortOptions",update:function(t){t.stopPropagation(),$("#displayList").val(""),$("#displayListSort > li").each(function(){var t=$("#displayList").val();""!=t?$("#displayList").val(t+","+$.trim($(this).html())):$("#displayList").val($.trim($(this).html()))}),siteManager.layoutmanager?siteManager.updateObjectPreview():siteManager.updateAvailableObject()}}).disableSelection()}}),!0},initSlideShowConfigurator:function(t){
/*
		if(typeof(data.object) !='undefined'){
			if(data.object !='feed_slideshow'){
				return false;
			}
		}
		*/
return this.initConfigurator(t,{url:"./",pars:"muraAction=cArch.loadclassconfigurator&compactDisplay=true&siteid="+siteid+"&classid=feed_slideshow&contentid="+contentid+"&parentid="+parentid+"&contenthistid="+contenthistid+"&regionid="+t.regionid+"&feedid="+t.objectid+"&cacheid="+Math.random(),title:slideShowConfiguratorTitle,init:function(t,e){$("#availableListSort, #displayListSort").sortable({connectWith:".displayListSortOptions",update:function(t){t.stopPropagation(),$("#displayList").val(""),$("#displayListSort > li").each(function(){var t=$("#displayList").val();""!=t?$("#displayList").val(t+","+$(this).html()):$("#displayList").val($(this).html())}),siteManager.layoutmanager?siteManager.updateObjectPreview():siteManager.updateAvailableObject()}}).disableSelection()}}),!0},initRelatedContentConfigurator:function(t){return this.initConfigurator(t,{url:"./",pars:"muraAction=cArch.loadclassconfigurator&compactDisplay=true&siteid="+siteid+"&classid="+t.object+"&contentid="+contentid+"&parentid="+parentid+"&contenthistid="+contenthistid+"&regionid="+t.regionid+"&objectid="+t.objectid+"&cacheid="+Math.random(),title:relatedContentConfiguratorTitle,init:function(t,e){$("#availableListSort, #displayListSort").sortable({connectWith:".displayListSortOptions",update:function(t){t.stopPropagation(),$("#displayList").val(""),$("#displayListSort > li").each(function(){var t=$("#displayList").val();""!=t?$("#displayList").val(t+","+$(this).html()):$("#displayList").val($(this).html())}),siteManager.layoutmanager?siteManager.updateObjectPreview():siteManager.updateAvailableObject()}}).disableSelection()}}),!0},initGenericConfigurator:function(t){return this.resetAvailableObject(),"backEnd"==this.configuratorMode&&this.resetConfiguratorContainer(),siteManager.layoutmanager?this.initConfigurator(t,{url:"./",pars:"muraAction=cArch.loadclassconfigurator&compactDisplay=true&siteid="+siteid+"&classid="+t.object+"&contentid="+contentid+"&parentid="+parentid+"&contenthistid="+contenthistid+"&regionid="+t.regionid+"&objectid="+t.objectid+"&cacheid="+Math.random(),title:t.title||t.name,iconclass:t.iconclass,init:function(t,e){}}):$("#configuratorContainer").dialog({resizable:!0,modal:!0,width:400,title:t.title||t.name,position:getDialogPosition(),buttons:{Cancel:function(){$(this).dialog("close")}},open:function(){
//$("#ui-dialog-title-configuratorContainer").html(genericConfiguratorTitle);
$("#configurator").html('<div class="ui-dialog-content ui-widget-content">'+genericConfiguratorMessage+"</div>")},close:function(){$(this).dialog("destroy")}}),!0},updateAvailableObject:function(){var e={};$(".objectParam, .objectparam").each(function(){var t=$(this);null!=t.val()&&("radio"!=t.attr("type")||"radio"==t.attr("type")&&t.is(":checked"))&&(t.attr("id")&&void 0!==CKEDITOR.instances[t.attr("id")]&&CKEDITOR.instances[t.attr("id")].updateElement(),void 0!==t.attr("name")&&(void 0===e[t.attr("name")]?"checkbox"!=t.attr("type")||t.is(":checked")?e[t.attr("name")]=t.val():e[t.attr("name")]="":("checkbox"!=t.attr("type")||t.is(":checked"))&&(e[t.attr("name")]=e[t.attr("name")]+","+t.val())))}),e.cssstyles={},$(".objectStyle, .objectstyle").each(function(){var t=$(this);null!=t.val()&&("radio"!=t.attr("type")||"radio"==t.attr("type")&&t.is(":checked"))&&void 0!==t.attr("name")&&(void 0===e.cssstyles[t.attr("name")]?"checkbox"!=t.attr("type")||t.is(":checked")?e.cssstyles[t.attr("name")]=t.val():e.cssstyles[t.attr("name")]="":("checkbox"!=t.attr("type")||t.is(":checked"))&&(e.cssstyles[t.attr("name")]=e.cssstyles[t.attr("name")]+","+t.val()))}),e.metacssstyles={},$(".metaStyle, .metastyle").each(function(){var t=$(this);null!=t.val()&&("radio"!=t.attr("type")||"radio"==t.attr("type")&&t.is(":checked"))&&void 0!==t.attr("name")&&(void 0===e.metacssstyles[t.attr("name")]?"checkbox"!=t.attr("type")||t.is(":checked")?e.metacssstyles[t.attr("name")]=t.val():e.metacssstyles[t.attr("name")]="":("checkbox"!=t.attr("type")||t.is(":checked"))&&(e.metacssstyles[t.attr("name")]=e.metacssstyles[t.attr("name")]+","+t.val()))}),e.contentcssstyles={},$(".contentStyle, .contentstyle").each(function(){var t=$(this);null!=t.val()&&("radio"!=t.attr("type")||"radio"==t.attr("type")&&t.is(":checked"))&&void 0!==t.attr("name")&&(void 0===e.contentcssstyles[t.attr("name")]?"checkbox"!=t.attr("type")||t.is(":checked")?e.contentcssstyles[t.attr("name")]=t.val():e.contentcssstyles[t.attr("name")]="":("checkbox"!=t.attr("type")||t.is(":checked"))&&(e.contentcssstyles[t.attr("name")]=e.contentcssstyles[t.attr("name")]+","+t.val()))}),this.availableObject=$.extend({},this.availableObjectTemplate),this.availableObject.params=e,this.availableObject.params.cssstyles=JSON.stringify(this.availableObject.params.cssstyles),this.availableObject.params.metacssstyles=JSON.stringify(this.availableObject.params.metacssstyles),this.availableObject.params.contentcssstyles=JSON.stringify(this.availableObject.params.contentcssstyles),"object"==typeof originParams&&(this.availableObject.params=$.extend(originParams,this.availableObject.params))},configuratorMap:{container:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},collection:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},text:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},embed:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},feed:{condition:function(){return!0},initConfigurator:function(t){siteManager.initFeedConfigurator(t)}},form:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},component:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},folder:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},gallery:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},calendar:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},form_responses:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},plugin:{condition:function(){return!0},initConfigurator:function(t){if(t.objectid&&"none"!=t.objectid.toLowerCase()&&siteManager.getPluginConfigurator(t.objectid)){var e=siteManager.getPluginConfigurator(t.objectid);window[e](t)}else siteManager.initGenericConfigurator(t)}},feed_slideshow:{condition:function(){return!0},initConfigurator:function(t){siteManager.initSlideShowConfigurator(t)}},tag_cloud:{condition:function(){return siteManager.customtaggroups.length},initConfigurator:function(t){siteManager.initTagCloudConfigurator(t)}},category_summary:{condition:function(){return!0},initConfigurator:function(t){siteManager.allowopenfeeds?siteManager.initCategorySummaryConfigurator(t):siteManager.initGenericConfigurator(t)}},archive_nav:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},calendar_nav:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},category_summary_rss:{condition:function(){return siteManager.allowopenfeeds},initConfigurator:function(t){siteManager.initCategorySummaryConfigurator(t)}},site_map:{condition:function(){return!0},initConfigurator:function(t){siteManager.initSiteMapConfigurator(t)}},related_content:{condition:function(){return!0},initConfigurator:function(t){siteManager.initRelatedContentConfigurator(t)}},related_section_content:{condition:function(){return!0},initConfigurator:function(t){siteManager.initRelatedContentConfigurator(t)}},system:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},comments:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},favorites:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},forward_email:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},event_reminder_form:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},rater:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},user_tools:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},goToFirstChild:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},navigation:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},sub_nav:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},peer_nav:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},standard_nav:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},portal_nav:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},folder_nav:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},multilevel_nav:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},seq_nav:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},top_nav:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},mailing_list:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}},mailing_list_master:{condition:function(){return!0},initConfigurator:function(t){siteManager.initGenericConfigurator(t)}}},customtaggroups:[],allowopenfeeds:!1,objectHasConfigurator:function(t){return t.object in this.configuratorMap&&this.configuratorMap[t.object].condition()},initDisplayObjectConfigurators:function(){var i=this;$(".displayRegions").dblclick(function(){var t=$(this).attr("data-regionid"),e=i.getDisplayObjectConfig(t);i.objectHasConfigurator(e)?i.configuratorMap[e.object].initConfigurator(e):i.initGenericConfigurator(e)})},resetAvailableObject:function(){this.availableObjectTemplate="",
//availalbeObjectParams={};
this.availableObject={},this.availableObjectValidate=function(){return!0}},resetConfiguratorContainer:function(){
//$(instance).dialog("destroy");
$("#configuratorContainer").remove(),$("body").append('<div id="configuratorContainer" title="Loading..." style="display:none"></div>');
/*
		if(siteManager.layoutmanager){
			var html='<div class="clearfix">'
			    html+='<div id="configurator" style="float: left; width: 70%;"><div class="load-inline"></div></div>';
			    html+='<div style="float: right; width: 30%;"><h2>Preview</h2>';
			    html+='<iframe id="configuratorPreview" style="width:100%;height:700px;" marginheight="0" marginwidth="0" frameborder="0" src=""></iframe>';
			    html+='</div>';
				html+='</div>';
		} else {
		*/
var t='<div id="configurator"><div class="load-inline"></div></div>';
//}
$("#configuratorContainer").html(t),$("#configuratorContainer .load-inline").spin(spinnerArgs2)},initConfiguratorParams:function(){this.updateAvailableObject(),$(".objectParam, .objectparam, .objectStyle, .objectstyle, .metaStyle, .metastyle, .contentStyle, .contentstyle").bind("change",function(){siteManager.updateAvailableObject()})},setContentDisplayListSort:function(){$("#contentAvailableListSort, #contentDisplayListSort").sortable({connectWith:".contentDisplayListSortOptions",update:function(t){t.stopPropagation(),$("#contentDisplayList").val(""),$("#contentDisplayListSort > li").each(function(){var t=$("#contentDisplayList").val();""!=t?$("#contentDisplayList").val(t+","+$.trim($(this).html())):$("#contentDisplayList").val($.trim($(this).html()))})}}).disableSelection()},
//CONFIG: URL,PARS,TITLE,INIT
configuratorMode:"backEnd",previewURL:"",loadObjectPreview:function(t){var e="core/utilities/objectpreview/";if(e+="?siteid=",e+=t.siteid,e+="&contenthistid=",e+=t.contenthistid,e+="&parentid=",e+=t.parentid,e+="&object=",e+=t.object,e+="&compactDisplay=true",e+="&objectid=",e+=t.objectid,e+="&params=",(e+=escape(t.params))!=siteManager.previewURL){var i=$("#configuratorPreview");i.length&&(siteManager.previewURL=e,i.attr("src",siteManager.previewURL))}},updateObjectPreview:function(){siteManager.updateAvailableObject(),configOptions.params=JSON.stringify(siteManager.availableObject.params),siteManager.loadObjectPreview(configOptions)},initConfigurator:function(data,config){if(this.resetAvailableObject(),this.previewURL="",void 0!==config.validate&&(this.availableObjectValidate=config.validate),data.configuratorMode=this.configuratorMode,void 0===data.object)return!1;if(siteManager.layoutmanager&&(data.layoutmanager=!0),"backEnd"==this.configuratorMode){siteManager.layoutmanager&&(configOptions=$.extend({},data),configOptions.params=configOptions.params||{}),this.resetConfiguratorContainer();var originid=data.objectid;$("#configuratorContainer").dialog({resizable:!0,modal:!0,width:600,position:getDialogPosition(),buttons:{Save:function(){siteManager.updateAvailableObject();var availableObjectSelector=$("#availableObjectSelector");if(availableObjectSelector.length){var selectedObject=eval("("+availableObjectSelector.val()+")");siteManager.availableObject.name=selectedObject.name,siteManager.availableObject.object=selectedObject.object,siteManager.availableObject.objectid=selectedObject.objectid,siteManager.availableObject.originid=originid,delete selectedObject.name,delete selectedObject.object,delete selectedObject.objectid,$.extend(siteManager.availableObject.params,selectedObject)}if(siteManager.availableObjectValidate(siteManager.availableObject.params)){
//for some reason the availableObject sometimes has methods from the string.prototype.
for(var p in void 0!==config.destroy&&config.destroy(data,config),$(this).dialog("destroy"),siteManager.availableObject)"function"==typeof siteManager.availableObject[p]&&delete siteManager.availableObject[p];configure="none"!=siteManager.availableObject.objectid&&originid!=siteManager.availableObject.objectid&&siteManager.getPluginConfigurator(siteManager.availableObject.objectid),siteManager.addDisplayObject(siteManager.availableObject,data.regionid,configure,!0)}},Cancel:function(){void 0!==config.destroy&&config.destroy(data,config),$(this).dialog("destroy")}},close:function(){void 0!==config.destroy&&config.destroy(data,config),$(this).dialog("destroy")}});var url=config.url+"?"+config.pars+"&contenttype="+document.contentForm.type.value+"&contentsubtype="+document.contentForm.subtype.value}else var url=config.url+"?"+config.pars;return $.ajax({url:url,dataType:"text",data:data,type:"post",success:function(_resp){try{resp=eval("("+_resp+")")}catch(t){-1!=_resp.indexOf("mura-primary-login-token")&&(location.href="./"),resp=_resp}if("object"==typeof resp?$("#configurator").html(resp.html):"xml"==typeof resp?$("#configurator").html(resp.toString()):$("#configurator").html(resp),$(".form-actions").show(),niceSelects=$(".mura #configurator select"),niceSelects.niceSelect&&niceSelects.each(function(){var t=$(this);(void 0===t.data("niceselect")||t.data("niceselect"))&&t.niceSelect()}),
//$("#configuratorContainer").parent().find("span.ui-dialog-title").html(test);
"frontEnd"==siteManager.configuratorMode?(wireupExterndalUIWidgets(),
//if(siteManager.layoutmanager){
-1<config.title.indexOf("<i class=")?$("#configuratorHeader").html(config.title):(config.iconclass=config.iconclass||"mi-cog",$("#configuratorHeader").html('<i class="'+config.iconclass+'"></i> '+config.title))):$("#configuratorContainer").dialog("option","title",config.title),""==siteManager.availableObjectTemplate){var availableObjectContainer=$("#availableObjectParams");siteManager.availableObjectTemplate={object:availableObjectContainer.attr("data-object"),objectid:availableObjectContainer.attr("data-objectid"),name:availableObjectContainer.attr("data-name")},siteManager.availableObjectTemplate.object=siteManager.availableObjectTemplate.object||data.object,siteManager.availableObjectTemplate.objectid=siteManager.availableObjectTemplate.objectid||data.objectid,siteManager.availableObjectTemplate.name=siteManager.availableObjectTemplate.name||data.name,siteManager.availableObject=$.extend({},siteManager.availableObjectTemplate)}void 0!==config.init&&("object"==typeof resp&&(data=$.extend(data,resp)),config.init(data,config)),siteManager.layoutmanager?(setTabs(),siteManager.updateAvailableObject(),$("#configurator").change(siteManager.updateAvailableObject)):siteManager.updateAvailableObject(),"backEnd"==siteManager.configuratorMode?$("#configuratorContainer").dialog("option","position",getDialogPosition()):"frontEnd"==siteManager.configuratorMode&&($("#actionButtons").show(),$("#configuratorNotices").show())}}),!0},getPluginConfigurator:function(t){for(var e=0;e<pluginConfigurators.length;e++)if(pluginConfigurators[e].objectid==t)return pluginConfigurators[e].init;return""},openContentDiff:function(i,a,n){return $("#contentDiffContainer").remove(),$("body").append('<div id="contentDiffContainer" title="Loading..." style="display:none"><div class="ui-dialog-content ui-widget-content"><div class="load-inline"></div></div></div>'),$("#contentDiffContainer .load-inline").spin(spinnerArgs2),$("#contentDiffContainer").dialog({resizable:!1,modal:!0,width:990,title:"Version History Comparison: Code & Attribute Diff",position:getDialogPosition(),open:function(){
//$("#ui-dialog-title-contentDiffContainer").html('Code Diff');
$("#contentDiffContainer").html('<div class="ui-dialog-content ui-widget-content"><div class="load-inline"></div></div>');var t="./index.cfm",e="muraAction=cArch.loaddiff&compactDisplay=true&siteid="+n+"&contenthistid1="+i+"&contenthistid2="+a+"&cacheid="+Math.random();$.ajax(t+"?"+e).done(function(t){-1!=t.indexOf("mura-primary-login-token")&&(location.href="./"),$("#contentDiffContainer .load-inline").spin(!1),$("#contentDiffContainer").html(t),$("#contentDiffContainer").dialog("option","position","center"),$(".ui-widget-overlay").css("height",$(document).height())}).fail(function(t){-1!=t.responseText.indexOf("mura-primary-login-token")&&(location.href="./"),$("#contentDiffContainer .load-inline").spin(!1),$("#contentDiffContainer").html(t.responseText),$("#contentDiffContainer").dialog("option","position","center")})},close:function(){$(this).dialog("destroy"),$("#contentDiffContainer").remove()}}),!1},openDisplayObjectModal:function(t,e){e=e||{};var i=Mura.getQueryStringParams(location.search);Mura.deepExtend(Mura.setLowerCaseKeys(i),Mura.setLowerCaseKeys(e)),i.sourceframe="modal",i.muraaction="carch.displayobjectmodal",i.view=t;
//console.log($params);
var a="?";for(var n in i)a=a+"&"+n+"="+encodeURIComponent(i[n]);frontEndProxy.post({cmd:"openModal",src:a})},setDisplayObjectModalWidth:function(t){t=t||"standard",$(function(){$("#ProxyIFrame").length?$("#ProxyIFrame").load(function(){frontEndProxy.post({cmd:"setWidth",width:t})}):frontEndProxy.post({cmd:"setWidth",width:t})})},updateDisplayObjectParams:function(t){t=t||{};var e=Mura.setLowerCaseKeys(Mura.getQueryStringParams(location.search));t=Mura.extend({},siteManager.availableObject.params,t),$(function(){$("#ProxyIFrame").length?$("#ProxyIFrame").load(function(){frontEndProxy.post({cmd:"setObjectParams",reinit:"sidebar"!=e.sourceframe,instanceid:e.instanceid,params:t})}):frontEndProxy.post({cmd:"setObjectParams",reinit:"sidebar"!=e.sourceframe,instanceid:e.instanceid,params:t})})},requestDisplayObjectParams:function(t,e){e=e||"modal";var a=t;siteManager.frontEndProxyListeners.push({cmd:"customObjectParamsRequest",fn:function(i){$(".objectParam, .objectparam").each(function(){var t=$(this);if("string"==typeof t.attr("name")){var e=t.attr("name").toLowerCase();void 0!==i[e]&&(t.is(":radio")?t.val().toString()==i[e].toString()&&t.attr("checked",!0):(t.val(i[e].toString()),t.is("SELECT")&&t.niceSelect("update"),t.attr("id")&&void 0!==CKEDITOR.instances[t.attr("id")]&&CKEDITOR.instances[t.attr("id")].updateElement()))}}),siteManager.initConfiguratorParams(),a(i)}});var i=Mura.getQueryStringParams(location.search);$(function(){$("#ProxyIFrame").length?$("#ProxyIFrame").load(function(){frontEndProxy.post({cmd:"requestObjectParams",instanceid:i.instanceid,targetFrame:e,callback:"customObjectParamsRequest"})}):frontEndProxy.post({cmd:"requestObjectParams",instanceid:i.instanceid,targetFrame:e,callback:"customObjectParamsRequest"})})},frontEndProxyListener:function(t){for(var e=t.data,i=siteManager.frontEndProxyListeners,a=0;a<i.length;a++)i[a].cmd==e.cmd&&(e.params?i[a].fn(e.params):i[a].fn(e),i[a].cmd="void")},frontEndProxyListeners:[]};quickEditTmpl='<div class="mura-quickEdit" id="mura-quickEditor">',quickEditTmpl+='<img class="loader" src="assets/images/ajax-loader-alt.gif" />',quickEditTmpl+="</div>",$(document).ready(function(){siteManager.initDisplayObjectConfigurators()});
MuraFileBrowser={config:{resourcepath:"User_Assets",directory:"",height:600,selectMode:0,endpoint:"",displaymode:2,selectCallback:function(){}},prettify:function(t){},render:function(t){var e=this,i="_"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);this.config=Mura.extend(t,this.config),this.endpoint=Mura.apiEndpoint+"filebrowser/",this.container=Mura("#MasaBrowserContainer"),this.container.append("<div id='"+i+"'><component :is='currentView'></component></div>"),this.target=i,this.main(),Mura.loader().loadcss(Mura.corepath+"/vendor/codemirror/codemirror.css").loadjs(Mura.adminpath+"/assets/js/vue.min.js",Mura.corepath+"/vendor/codemirror/codemirror.js",function(){e.mountbrowser()}),this.getURLVars()},main:function(t){},onError:function(t){console.log(t)},getURLVars:function(){var t={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(e,i,n){t[i]=n});t.CKEditorFuncNum&&(this.callback=t.CKEditorFuncNum)},validate:function(){return!0},getEditFile:function(t,e,i){var n=null==t?"":t,s=this.endpoint+"/edit?directory="+n+"&filename="+e.fullname+"&resourcepath="+this.config.resourcepath;if(!this.validate())return error("No Access");Mura.get(s).then(function(t){i(t)},function(t){onError(t)})},moveFile:function(t,e,i,n){if(!this.validate())return error("No Access");Mura.getEntity("filebrowser").invokeWithCSRF("move",{directory:e,destination:i,resourcepath:this.config.resourcepath,filename:t.fullname},"post").then(function(t){n(t)},function(t){this.onError(t)})},getChildren:function(t,e){if(!this.validate())return error("No Access");Mura.getEntity("filebrowser").invokeWithCSRF("children",{directory:t,resourcepath:this.config.resourcepath},"post").then(function(t){e(t)},function(t){this.onError(t)})},doDeleteFile:function(t,e,i,n){var s=null==t?"":t,r=(this.endpoint,e.fullname,this.config.resourcepath,{resourcepath:this.config.resourcepath,directory:s,filename:e.fullname});if(!this.validate())return error("No Access");Mura.getEntity("filebrowser").invokeWithCSRF("delete",r,"post").then(function(t){t.success&&"0"!=t.success?i(t):n(t)},function(t){n(t)})},doDuplicateFile:function(t,e,i,n){var s=null==t?"":t,r={resourcepath:this.config.resourcepath,completepath:this.config.completepath,directory:s,file:e};if(!this.validate())return error("No Access");Mura.getEntity("filebrowser").invokeWithCSRF("duplicate",r,"post").then(function(t){i(t)},function(t){n(t)})},doUpdateContent:function(t,e,i,n,s){var r=null==t?"":t,o={resourcepath:this.config.resourcepath,completepath:this.config.completepath,directory:r,filename:e.fullname,content:i};if(!this.validate())return error("No Access");Mura.getEntity("filebrowser").invokeWithCSRF("update",o,"post").then(function(t){n(t)},function(t){s(t)})},doRenameFile:function(t,e,i,n){var s=null==t?"":t,r=(this.endpoint,e.fullname,e.name,this.config.resourcepath,{resourcepath:this.config.resourcepath,completepath:this.config.completepath,directory:s,filename:e.fullname,name:e.name});if(!this.validate())return error("No Access");Mura.getEntity("filebrowser").invokeWithCSRF("rename",r,"post").then(function(t){i(t)},function(t){n(t)})},doNewFolder:function(t,e,i){var n=null==t?"":t,s={resourcepath:this.config.resourcepath,completepath:this.config.completepath,directory:n,name:e};if(!this.validate())return error("No Access");Mura.getEntity("filebrowser").invokeWithCSRF("addfolder",s,"post").then(function(t){i(t)},function(t){onError(t)})},loadDirectory:function(t,e,i,n,s,r,o,l){var a=null==t?"":t,c=this.endpoint+"browse?directory="+a+"&resourcepath="+this.config.resourcepath;if(!this.validate())return error("No Access");e&&(c+="&pageindex="+e),l&&(c+="&itemsperpage="+l),s.length&&(c+="&filterResults="+s),Mura.get(c).then(function(t){i(t)},function(t){n(t)})},loadBaseDirectory:function(t,e,i){var n=i||this.config.directory,s=this.endpoint+"/browse?resourcepath="+this.config.resourcepath+"&directory="+n+"&settings=1";if(!this.validate())return error("No Access");Mura.get(s).then(function(e){t(e)},function(t){e(t)})},doUpload:function(t,e,i){t.append("resourcepath",this.config.resourcepath);var n={};t.forEach(function(t,e){n[e]=t});JSON.stringify(n);if(!this.validate())return error("No Access");Mura.getEntity("filebrowser").invokeWithCSRF("upload",t,"post").then(function(t){e(t,i)},function(t){onError(t)})},rotate:function(t,e,i,n){var s={resourcepath:this.config.resourcepath,completepath:this.config.completepath,file:JSON.parse(JSON.stringify(t)),direction:e};if(!this.validate())return n("No Access");Mura.getEntity("filebrowser").invokeWithCSRF("rotate",s,"post").then(function(t){i(t)},function(t){onError(t)})},performResize:function(t,e,i,n){var s={resourcepath:this.config.resourcepath,completepath:this.config.completepath,file:JSON.parse(JSON.stringify(t)),dimensions:e};if(!this.validate())return n("No Access");Mura.getEntity("filebrowser").invokeWithCSRF("resize",s,"post").then(function(t){i(t)},function(t){onError(t)})},performCrop:function(t,e,i){if(!this.validate())return i("No Access");var n={},s=document.getElementById("imagediv"),r=document.getElementById("croprectangle"),o=r.getBoundingClientRect(),l=(t.info.width,t.info.height,{width:s.clientWidth,height:s.clientHeight}),a={x:0,y:0,width:0,height:0};a.x=r.oLeft,a.y=r.oTop,a.width=o.width,a.height=o.height,n.file=JSON.parse(JSON.stringify(t)),n.crop=a,n.size=l,Mura.getEntity("filebrowser").invokeWithCSRF("processCrop",n,"post").then(function(t){e(t)},function(t){onError(t)})},crop:function(t,e){if(1!=e){var i={x:0,y:0,startX:0,startY:0},n=null;t.onmousemove=function(t){null!==n&&(r(t),n.style.width=Math.abs(i.x-i.startX)+"px",n.style.height=Math.abs(i.y-i.startY)+"px",n.style.left=i.x-i.startX<0?i.x+"px":i.startX+"px",n.style.top=i.y-i.startY<0?i.y+"px":i.startY+"px")},t.onmouseup=function(e){n=null,t.style.cursor="default"},t.onmousedown=function(e){if(null!==n);else{var s=document.getElementById("croprectangle");s&&s.parentNode.removeChild(s),r(e),i.startX=i.x,i.startY=i.y;t.getBoundingClientRect();(n=document.createElement("div")).className="rectangle",n.id="croprectangle",n.style.width=Math.abs(i.x-i.startX)+"px",n.style.height=Math.abs(i.y-i.startY)+"px",n.style.left=i.x-i.startX<0?i.x+"px":i.startX+"px",n.style.top=i.y-i.startY<0?i.y+"px":i.startY+"px",t.appendChild(n),t.style.cursor="crosshair"}}}else{var s=document.getElementById("croprectangle");s&&s.parentNode.removeChild(s)}function r(e){var n=e||window.event;t.getBoundingClientRect();n.pageX?e.target!=document.getElementById("imagediv")?(i.x=e.offsetX+e.target.oLeft,i.y=e.offsetY+e.target.oTop):(i.x=n.offsetX,i.y=n.offsetY):n.clientX&&(i.x=n.offsetX,i.y=n.offsetY)}},mountbrowser:function(){var t=this;Vue.directive("click-outside",{bind:function(t,e,i){t.clickOutsideEvent=function(n){t==n.target||t.contains(n.target)||i.context[e.expression](n)},document.body.addEventListener("click",t.clickOutsideEvent)},unbind:function(t){document.body.removeEventListener("click",t.clickOutsideEvent)}}),Vue.component("contextmenu",{props:["currentFile","menuy","menux","bottom"],template:'\n\t\t<div id="newContentMenu" class="addNew" v-bind:style="{ left: (menux + 20) + \'px\',top: getTop() + \'px\' }">\n\t\t\t<ul id="newContentOptions">\n\t\t\t\t<li v-if="checkIsFile() && checkSelectMode()"><a href="#" @click.prevent="selectFile()"><i class="mi-check"></i>Select</a></li>\n\t\t\t\t<li v-if="checkIsFile() && checkFileEditable()"><a href="#" @click.prevent="editFile()"><i class="mi-pencil"></i>Edit</a></li>\n\t\t\t\t<li v-if="checkIsFile() && checkImageType()"><a href="#" @click.prevent="viewFile()"><i class="mi-image"></i>View</a></li>\n\t\t\t\t<li v-if="checkIsFile() || checkImageType()"><a href="#" @click.prevent="moveFile()"><i class="mi-move"></i>Move</a></li>\n\t\t\t\t<li v-if="checkIsFile() && checkImageType()"><a href="#" @click.prevent="duplicateFile()"><i class="mi-copy"></i>Duplicate</a></li>\n\t\t\t\t<li><a href="#" @click.prevent="renameFile()"><i class="mi-edit"> Rename</i></a></li>\n\t\t\t\t<li v-if="checkIsFile()"><a href="#" @click="downloadFile()"><i class="mi-download"> Download</i></a></li>\n\t\t\t\t<li class="delete"><a href="#" @click="deleteFile()"><i class="mi-trash"> Delete</i></a></li>\n\t\t\t</ul>\n\t\t\t</div>\n\t\t',data:()=>({posx:0,posy:0}),computed:{},mounted:function(){},methods:{compstyle:function(){this.posx=this.menux,this.posy=this.menuy},getTop:function(){return this.menuy+window.pageYOffset},selectFile:function(){if(1!=MuraFileBrowser.config.selectMode)return window.close(),e.currentFile.rootpath=MuraFileBrowser.rootpath,MuraFileBrowser.config.selectCallback(e.currentFile);var i=e.currentFile.url;i.includes("://")&&(i=i.replace(/^(.[^\/]*['\:\/\/'].[^\/]*)(.*)$/,"$2")),window.opener.CKEDITOR.tools.callFunction(t.callback,i),window.close()},editFile:function(){e.editFile(this.successEditFile)},duplicateFile:function(){e.duplicateFile(e.refresh,e.displayError)},viewFile:function(){e.isDisplayWindow="VIEW",e.viewFile()},successEditFile:function(t){this.currentFile.content=t.data.content,e.isDisplayWindow="EDIT"},renameFile:function(){e.isDisplayWindow="RENAME"},moveFile:function(){e.isDisplayWindow="MOVE"},downloadFile:function(){window.open(e.currentFile.url,"_blank")},deleteFile:function(){e.isDisplayWindow="DELETE"},checkSelectMode:function(){return e.checkSelectMode()},checkFileEditable:function(){return e.checkFileEditable()},checkImageType:function(){return e.checkImageType()},checkIsFile:function(){return e.checkIsFile()}}}),Vue.component("actionwindow",{props:["isDisplayWindow","currentFile","currentIndex","error","foldertree"],template:'\n\t\t\t<div id="actionwindow-wrapper">\n\t\t\t<editwindow v-if="isDisplayWindow==\'EDIT\'" :currentFile="currentFile"></editwindow>\n\t\t\t<renamewindow v-if="isDisplayWindow==\'RENAME\'" :currentFile="currentFile"></renamewindow>\n\t\t\t<addfolderwindow v-if="isDisplayWindow==\'ADDFOLDER\'" :currentFile="currentFile"></addfolderwindow>\n\t\t\t<downloadwindow v-if="isDisplayWindow==\'DOWNLOAD\'" :currentFile="currentFile"></downloadwindow>\n\t\t\t<deletewindow v-if="isDisplayWindow==\'DELETE\'" :currentFile="currentFile"></deletewindow>\n\t\t\t<movewindow v-if="isDisplayWindow==\'MOVE\'" :foldertree="foldertree" :currentFile="currentFile"></movewindow>\n\t\t\t<errorwindow v-if="isDisplayWindow==\'ERROR\'" :currentFile="currentFile" :error="error"></errorwindow>\n\t\t\t</div>\n\t\t',data:()=>({}),methods:{}}),Vue.component("movewindow",{props:["files","folders","foldertree","isDisplayContext","currentFile"],template:'\n\t\t\t<div class="ui-dialog actionwindow-formwrapper">\n\t\t\t\t<div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<span class="ui-dialog-title">Move</span>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<label>Name: <span>{{currentFile.fullname}}</span></label>\n\t\t\t\t\t\t\t<label>Location: <span>{{this.$root.resourcepath}}</span><span v-for="(item, index) in foldertree"> / {{item}}</span> </label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t\tMove to:\n\t\t\t\t\t\t\t\t<span><a @click="setDir(-1)" class="folder-item">{{this.$root.resourcepath}}</a></span>\n\t\t\t\t\t\t\t\t\t<span v-for="(item,index) in sourcefolders" @click="setDir(index)"> / <a class="folder-item">{{item}}</a></span>\n\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t<select v-if="children.length" v-model="folderName">\n\t\t\t\t\t\t\t\t\t\t<option v-if="item.length" v-for="item in children" :value="item">/{{item}}</option>\n\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="buttonset">\n\t\t\t\t\t\t\t<button @click="moveFile()">Move</button>\n\t\t\t\t\t\t\t<button class="mura-secondary" @click="cancel()">Cancel</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t',data:()=>({folderName:"",sourcefolders:[],children:[],invalid:""}),watch:{folderName:function(t){if(""!=this.folderPath){this.sourcefolders.push(this.folderName);var e="";for(i in this.sourcefolders)e+="/"+this.sourcefolders[i];this.children=[],MuraFileBrowser.getChildren(e,this.update)}}},methods:{moveFile:function(){var t="",n="";for(i in e.foldertree)t+="/"+e.foldertree[i];for(i in this.sourcefolders)n+="/"+this.sourcefolders[i];e.spinnermodal=1,MuraFileBrowser.moveFile(this.currentFile,t,n,this.isMoved)},isMoved:function(){e.isDisplayWindow="",e.refresh()},setDir:function(t){t+=1,this.sourcefolders.length=t;var e="";for(i in this.sourcefolders)e+="/"+this.sourcefolders[i];this.children=[],MuraFileBrowser.getChildren(e,this.update)},update:function(t){parseInt(t.success)?(this.invalid="",this.children=t.folders):(this.children=[],this.invalid="(This is not a valid directory)")},cancel:function(){e.isDisplayWindow=""}},mounted:function(){this.sourcefolders=this.foldertree.slice(0),this.filename=this.currentFile.name,e.isDisplayContext=0;var t="";for(i in this.sourcefolders)t+="/"+this.sourcefolders[i];MuraFileBrowser.getChildren(t,this.update)}}),Vue.component("renamewindow",{props:["currentFile"],template:'\n\t\t\t<div class="ui-dialog dialog-nobg actionwindow-formwrapper">\n\t\t\t<div>\n\t\t\t\t<span class="ui-dialog-title">Rename</span>\n\t\t\t\t<div>\n\t\t\t\t\t<label>Name:</label>\n\t\t\t\t\t<input type="text" v-model="filename"></input>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="buttonset">\n\t\t\t\t<button @click="updateRename()">Save</button>\n\t\t\t\t<button @click="cancel()">Cancel</button>\n\t\t\t</div>\n\t\t\t</div>\n\t\t',data:()=>({filename:""}),methods:{updateRename:function(){this.currentFile.name=this.filename,e.renameFile(),e.isDisplayWindow=""},cancel:function(){e.isDisplayWindow=""}},mounted:function(){this.filename=this.currentFile.name,e.isDisplayContext=0}}),Vue.component("errorwindow",{props:["error"],template:'\n\t\t\t<div class="ui-dialog dialog-confirm ui-dialog actionwindow-formwrapper">\n\t\t\t<div>\n\t\t\t\t<span class="ui-dialog-title">Error</span>\n\t\t\t\t<h4>{{error}}</h4>\n\t\t\t</div>\n\t\t\t<div class="buttonset">\n\t\t\t\t<button @click="cancel()">Close</button>\n\t\t\t</div>\n\t\t\t</div>\n\t\t',data:()=>({filename:""}),methods:{cancel:function(){e.isDisplayWindow=""}}}),Vue.component("addfolderwindow",{props:["currentFile"],template:'\n\t\t\t<div class="ui-dialog dialog-nobg actionwindow-formwrapper">\n\t\t\t<div>\n\t\t\t\t<span class="ui-dialog-title">Add Folder</span>\n\t\t\t\tName:\n\t\t\t\t<input type="text" v-model="foldername"></input>\n\t\t\t</div>\n\t\t\t<div class="buttonset">\n\t\t\t\t<button @click="newFolder()">Save</button>\n\t\t\t\t<button @click="cancel()">Cancel</button>\n\t\t\t</div>\n\t\t\t</div>\n\t\t',data:()=>({foldername:""}),methods:{newFolder:function(){e.newFolder(this.foldername),e.isDisplayWindow=""},cancel:function(){e.isDisplayWindow=""}},mounted:function(){}}),Vue.component("gallerywindow",{props:["currentFile","currentIndex","total"],template:'\n\t\t\t<div class="fileviewer-modal">\n\t\t\t<div class="fileviewer-gallery" v-click-outside="closewindow">\n\t\t\t\t<div class="fileviewer-image" :style="{ \'background-image\': \'url(\' + encodeURI(currentFile.url) + \'?\' + Math.ceil(Math.random()*100000) + \')\' }"></div>\n\t\t\t\t<div>\n\t\t\t\t\t<div class="actionwindow-left" @click="lastimage"><i class="mi-caret-left"></i></div>\n\t\t\t\t\t<div class="actionwindow-right" @click="nextimage"><i class="mi-caret-right"></i></div>\n\t\t\t\t\t<div class="fileviewer-gallery-menu">\n\t\t\t\t\t<ul>\n\t\t\t\t\t\t<li v-if="checkImageType() && checkSelectMode()"><a @click="selectFile()"><i class="mi-check"></i>Select</a></li>\n\t\t\t\t\t\t<li v-if="checkImageType()"><a @click="editImage()"><i class="mi-check"></i>Edit Image</a></li>\n\t\t\t\t\t\t<li v-if="checkFileEditable()"><a @click="editFile()"><i class="mi-pencil"></i>Edit</a></li>\n\t\t\t\t\t\t<li><a @click="renameFile()"><i class="mi-edit"></i>Rename</a></li>\n\t\t\t\t\t\t<li v-if="checkIsFile()"><a @click="downloadFile()"><i class="mi-download"></i>Download</a></li>\n\t\t\t\t\t\t<li><a @click="deleteFile()"><i class="mi-trash"></i>Delete</a></li>\n\t\t\t\t\t\t<li><a @click="closewindow()"><i class="mi-times"></i>Close</a></li>\n\t\t\t\t\t</ul>\n\t\t\t\t\t<p>{{currentFile.fullname}} ({{currentFile.size}}kb <span v-if="checkImageType()">{{currentFile.info.width}}x{{currentFile.info.height}}</span>)</p>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t</div>\n\t\t',data:()=>({}),mounted:function(){this.$root.isDisplayContext=0},methods:{lastimage:function(){e.previousFile(1)},nextimage:function(){e.nextFile(1)},closewindow:function(t){this.$root.isDisplayWindow=""},selectFile:function(){if(1!=MuraFileBrowser.config.selectMode)return MuraFileBrowser.config.selectCallback(e.currentFile);var i=e.currentFile.url;i.includes("://")&&(i=i.replace(/^(.[^\/]*['\:\/\/'].[^\/]*)(.*)$/,"$2")),window.opener.CKEDITOR.tools.callFunction(t.callback,i),window.close()},renameFile:function(){e.isDisplayWindow="RENAME"},editImage:function(){e.isDisplayWindow="EDITIMAGE"},downloadFile:function(){window.open(e.currentFile.url,"_blank")},deleteFile:function(){e.isDisplayWindow="DELETE"},checkSelectMode:function(){return e.checkSelectMode()},checkFileEditable:function(){return e.checkFileEditable()},checkImageType:function(){return e.checkImageType()},checkIsFile:function(){return e.checkIsFile()}}}),Vue.component("imageeditwindow",{props:["currentFile","currentIndex","total"],template:'\n\t\t<div class="fileviewer-modal">\n\t\t\t<imageeditmenu class="fileviewer-gallery" :currentFile="currentFile" :currentIndex="currentIndex" v-click-outside="closewindow"></imageeditmenu>\n\t\t</div>\n\t\t',data:()=>({}),mounted:function(){},methods:{closewindow:function(t){this.$root.isDisplayWindow=""}}}),Vue.component("imageeditmenu",{props:["currentFile","currentIndex"],template:'\n\t\t\t <div class="fileviewer-modal">\n\t\t\t<div class="fileviewer-image" id="imagediv" :style="{ \'background-image\': \'url(\' + encodeURI(currentFile.url) + \'?\' + Math.ceil(Math.random()*100000) + \')\' }"></div>\n\t\t\t<div>\n\t\t\t\t<div class="fileviewer-gallery-menu">\n\t\t\t\t<ul>\n\t\t\t\t  \x3c!--- MAIN ---\x3e\n\t\t\t\t  <span v-if="editmode==\'\'">\n\t\t\t\t\t\x3c!--- <li><a @click="crop()"><i class="mi-crop"> Crop</i></a></li> ---\x3e\n\t\t\t\t\t<li><a @click="rotateRight()"><i class="mi-rotate-right"> Rotate Right</i></a></li>\n\t\t\t\t\t<li><a @click="rotateLeft()"><i class="mi-rotate-left"> Rotate Left</i></a></li>\n\t\t\t\t\t<li><a @click="resize()"><i class="mi-expand"> Resize</i></a></li>\n\t\t\t\t\t<li><a @click="cancel()"><i class="mi-chevron-left"> Back</i></a></li>\n\t\t\t\t\t</span>\n\t\t\t\t\t\x3c!--- CROP ---\x3e\n\t\t\t\t\t<span  v-if="editmode==\'CROP\'">\n\t\t\t\t\t<li><a @click="confirmCrop()"><i class="mi-check"> Confirm</i></a></li>\n\t\t\t\t\t<li><a @click="cancel()"><i class="mi-times"> Cancel</i></a></li>\n\t\t\t\t\t</span>\n\t\t\t\t\t\x3c!--- RESIZE ---\x3e\n\t\t\t\t\t<span  v-if="editmode==\'RESIZE\'">\n\t\t\t\t\t<li>Width: <input :disabled="resizedimensions.aspect == \'height\'" name="resize-width" v-model="resizedimensions.width"></li>\n\t\t\t\t\t<li>Height: <input :disabled="resizedimensions.aspect == \'width\'" name="resize-height" v-model="resizedimensions.height"></li>\n\t\t\t\t\t<li>Aspect:\n\t\t\t\t\t\t<select name="resize-aspect" v-model="resizedimensions.aspect">\n\t\t\t\t\t\t<option value="none">None</option>\n\t\t\t\t\t\t<option value="height">Height</option>\n\t\t\t\t\t\t<option value="width">Width</option>\n\t\t\t\t\t\t<option value="within">Within</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li><a @click="confirmResize()"><i class="mi-check"> Confirm</i></a></li>\n\t\t\t\t\t<li><a @click="cancel()"><i class="mi-times"> Cancel</i></a></li>\n\t\t\t\t\t</span>\n\t\t\t\t</ul>\n\t\t\t\t<p>{{currentFile.fullname}} ({{currentFile.size}}kb {{currentFile.info.width}}x{{currentFile.info.height}})</p>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t</div>\n\t\t',data:()=>({editmode:"",resizedimensions:{width:0,height:0,backup:0,aspect:"none"}}),mounted:function(){this.resizedimensions.width=this.currentFile.info.width,this.resizedimensions.height=this.currentFile.info.height,this.$root.isDisplayContext=0,this.editmode=""},methods:{rotateLeft:function(){MuraFileBrowser.rotate(this.currentFile,"counterclock",this.rotateComplete)},rotateRight:function(){MuraFileBrowser.rotate(this.currentFile,"clock",this.rotateComplete)},rotateComplete(){this.$root.refresh(null,null,displaywindow="EDITIMAGE")},resize(){this.editmode="RESIZE"},confirmResize(){MuraFileBrowser.performResize(this.currentFile,this.resizedimensions,this.resizeComplete)},resizeComplete(){this.$root.refresh(null,null,displaywindow="EDITIMAGE")},crop:function(){this.editmode="CROP",MuraFileBrowser.crop(document.getElementById("imagediv"))},confirmCrop:function(){MuraFileBrowser.performCrop(this.currentFile,this.cropComplete)},cropComplete:function(){this.$root.refresh()},closewindow:function(t){this.$root.isDisplayWindow=""},cancel:function(t){this.$root.isDisplayWindow="VIEW",this.editmode=""}}}),Vue.component("deletewindow",{props:["currentFile"],template:'\n\t\t\t<div class="ui-dialog dialog-confirm actionwindow-formwrapper">\n\t\t\t<span class="ui-dialog-title">Delete</span>\n\t\t\t\t<p>Confirm Deletion: {{currentFile.fullname}}</p>\n\t\t\t\t<div class="buttonset">\n\t\t\t\t<button @click="doDelete()">Delete</button>\n\t\t\t\t<button @click="cancel()">Cancel</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t',data:()=>({}),methods:{doDelete:function(){e.deleteFile(e.refresh,e.displayError),e.isDisplayWindow=""},cancel:function(){e.isDisplayWindow=""}}}),Vue.component("editwindow",{props:["currentFile"],template:'\n\t\t\t<div class="ui-dialog dialog-nobg actionwindow-formwrapper">\n\t\t\t<span class="ui-dialog-title">Edit</span>\n\t\t\t<textarea id="contenteditfield" class="editwindow" v-model="filecontent"></textarea>\n\t\t\t<div class="buttonset">\n\t\t\t\t<button @click="updateContent()">Update</button>\n\t\t\t\t<button @click="cancel()">Cancel</button>\n\t\t\t</div>\n\t\t\t</div>\n\t\t',data:()=>({filecontent:""}),methods:{updateContent:function(){e.updateContent(this.filecontent),e.isDisplayWindow=""},cancel:function(){e.isDisplayWindow=""},selectAll:function(){editor.commands.selectAll(this.editor)},autoFormat:function(){}},mounted:function(){this.filecontent=this.currentFile.content}}),Vue.component("appbar",{props:["links","isbottomnav","response","itemsper","location"],template:'\n\t\t\t<div class="filewindow-appbar">\n\t\t\t\t<navmenu v-if="response.links" :links="links" :response="response" :itemsper="itemsper" :isbottomnav="isbottomnav"></navmenu>\n\t\t\t\t<modemenu v-if="location"></modemenu>\n\t\t\t</div>\n\t\t',data:function(){return{}},computed:{},methods:{applyPage:function(t){var i=1;"last"==t?i=parseInt(e.response.totalpages):"next"==t?i=parseInt(e.response.pageindex)+1:"previous"==t&&(i=parseInt(e.response.pageindex)-1),this.$parent.refresh("",i)},applyItemsPer:function(){this.$parent.itemsper=this.itemsper}}}),Vue.component("modemenu",{props:["links","isbottomnav","response","itemsper","displaymode"],template:'\n\t\t\t<div class="filewindow-modemenu">\n\t\t\t\t<div class="btn-group btn-group-toggle" data-toggle="buttons">\n\t\t\t\t<a class="btn btn-secondary" v-bind:class="{ highlight: viewmode == 1 }" @click="switchMode(1)">\n\t\t\t\t\t<i class="mi-th" title="Grid View"></i>\n\t\t\t\t</a>\n\t\t\t\t<a class="btn btn-secondary" v-bind:class="{ highlight: viewmode == 2 }" @click="switchMode(2)">\n\t\t\t\t\t<i class="mi-bars" title="List View"></i>\n\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t\t<a @click="newFolder" class="btn btn-secondary">\n\t\t\t\t<i class="mi-folder" title="Add Folder"></i>\n\t\t\t\t</a>\n\t\t\t\t<input class="filebrowser-filter" placeholder="Type to filter" v-model="filterResults" v-on:input="filterChange">\n\t\t\t</div>\n\t\t',data(){return{viewmode:this.$root.displaymode,filterResults:"",timeout:void 0}},methods:{switchMode:function(t){var e={displaymode:JSON.parse(JSON.stringify(t))};Mura.createCookie("fbDisplayMode",JSON.stringify(e),1e3),this.$root.displaymode=this.viewmode=t},newFolder:function(){e.isDisplayWindow="ADDFOLDER"},filterChange:function(t,e){this.timeout&&window.clearTimeout(this.timeout),this.$root.filterResults=this.filterResults,this.timeout=window.setTimeout(this.$root.refresh,500)}}}),Vue.component("navmenu",{props:["links","isbottomnav","response","itemsper"],template:'\n\t\t\t<div class="filewindow-navmenu">\n\t\t\t\t<p v-if="isbottomnav">\n\t\t\t\t{{response.pageindex}} of {{response.totalpages}} \x3c!-- ({{response.totalitems}}) includes folders --\x3e\n\t\t\t\t</p>\n\t\t\t<ul class="pagination" v-if="response.totalitems>=25">\n\t\t\t\t<li class="paging" v-if="links.previous || links.next">\n\t\t\t\t<a href="#" v-if="links.first" @click.prevent="applyPage(\'first\')">\n\t\t\t\t\t<i class="mi-angle-double-left"></i>\n\t\t\t\t</a>\n\t\t\t\t<a v-else class="disabled">\n\t\t\t\t\t<i class="mi-angle-double-left"></i>\n\t\t\t\t</a>\n\t\t\t\t</li>\n\t\t\t\t<li class="paging" v-if="links.previous || links.next">\n\t\t\t\t<a href="#" v-if="links.previous" @click.prevent="applyPage(\'previous\')">\n\t\t\t\t\t<i class="mi-angle-left"></i>\n\t\t\t\t</a>\n\t\t\t\t<a v-else class="disabled">\n\t\t\t\t\t<i class="mi-angle-left"></i>\n\t\t\t\t</a>\n\t\t\t\t</li>\n\t\t\t\t<li class="paging" v-if="links.previous || links.next">\n\t\t\t\t<a href="#" v-if="links.next" @click.prevent="applyPage(\'next\')">\n\t\t\t\t\t<i class="mi-angle-right"></i>\n\t\t\t\t</a>\n\t\t\t\t<a v-else class="disabled">\n\t\t\t\t\t<i class="mi-angle-right"></i>\n\t\t\t\t</a>\n\t\t\t\t</li>\n\t\t\t\t<li class="paging paging-last" v-if="links.previous || links.next">\n\t\t\t\t<a href="#" v-if="links.last" @click.prevent="applyPage(\'last\')">\n\t\t\t\t\t<i class="mi-angle-double-right"></i>\n\t\t\t\t</a>\n\t\t\t\t<a v-else class="disabled">\n\t\t\t\t\t<i class="mi-angle-double-right"></i>\n\t\t\t\t</a>\n\t\t\t\t</li>\n\t\n\t\t\t\t<li class="pull-right">\n\t\t\t\t<select class="itemsper" @change="applyItemsPer" v-model="itemsper">\n\t\t\t\t\t<option value=\'25\' :selected="itemsper == 25 ? \'selected\' : null">25</option>\n\t\t\t\t\t<option value=\'50\' :selected="itemsper == 50 ? \'selected\' : null">50</option>\n\t\t\t\t\t<option value=\'100\' :selected="itemsper == 100 ? \'selected\' : null">100</option>\n\t\t\t\t\t<option value=\'9999\' :selected="itemsper == 9999 ? \'selected\' : null">All</option>\n\t\t\t\t</select>\n\t\t\t\t</li>\n\t\t\t\t<li class="pull-right"><label class="itemsper-label">View in groups of </label></li>\n\t\n\t\t\t</ul>\n\t\t\t</div>\n\t\t',data(){},methods:{applyPage:function(t){var i=1;"last"==t?i=parseInt(e.response.totalpages):"next"==t?i=parseInt(e.response.pageindex)+1:"previous"==t&&(i=parseInt(e.response.pageindex)-1),this.$root.refresh("",i)},applyItemsPer:function(){this.$root.itemsper=this.itemsper,this.$root.refresh()}}}),Vue.component("listmode",{props:["files","folders","foldertree","isDisplayContext","currentFile","settings"],template:'\n\t\t\t<div class="listmode-wrapper">\n\t\t\t<table class="mura-table-grid">\n\t\t\t\t<thead>\n\t\t\t\t<tr>\n\t\t\t\t\t<th class="actions">\n\t\t\t\t\t<a v-if="foldertree.length" class="folder-back" href="#" @click.prevent="back()">\n\t\t\t\t\t\t&nbsp;\n\t\t\t\t\t\t<i class="mi-arrow-circle-o-left"></i>\n\t\t\t\t\t</a>\n\t\t\t\t\t</th>\n\t\t\t\t\t<th class="var-width">{{settings.rb.filebrowser_filename}}</th>\n\t\t\t\t\t<th>{{settings.rb.filebrowser_size}}</th>\n\t\t\t\t\t<th>{{settings.rb.filebrowser_modified}}</th>\n\t\t\t\t</tr>\n\t\t\t\t</thead>\n\t\t\t\t<tbody>\n\t\t\t\t<tr v-if="files.length==0">\n\t\t\t\t\t<td class="actions"></td>\n\t\t\t\t\t<td class="var-width">No Results</td>\n\t\t\t\t\t<td></td>\n\t\t\t\t\t<td></td>\n\t\t\t\t</tr>\n\t\t\t\t<tr v-for="(file,index) in files">\n\t\t\t\t\t<td class="actions">\n\t\t\t\t\t\t<a href="#" :id="\'fileitem-\'+index" class="show-actions" @click.prevent="openMenu($event,file,index)"><i class="mi-ellipsis-v"></i></a>\n\t\t\t\t\t\t<div class="actions-menu hide">\n\t\t\t\t\t\t\t<ul class="actions-list">\n\t\t\t\t\t\t\t<li class="edit"><a @contextmenu="openMenu($event,file,index)"><i class="mi-pencil"></i>View</a></li>\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class="var-width">\n\t\t\t\t\t\t<a v-if="parseInt(file.isfile)" href="#" @click.prevent="viewFile(file,index)">{{file.fullname}}</a>\n\t\t\t\t\t\t<a v-else href="#" @click.prevent="refresh(file.name)"><i class="mi-folder"></i> {{file.fullname}}</a>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t<div v-if="parseInt(file.isfile)">\n\t\t\t\t\t\t{{file.size}}kb\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t<div v-else>\n\t\t\t\t\t\t--\n\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t{{file.lastmodifiedshort}}\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\n\t\t\t\t</tbody>\n\t\t\t</table>\n\t\t\t<contextmenu :currentFile="this.$parent.currentFile" :isDisplayContext="this.$root.isDisplayContext" v-if="isDisplayContext" :menux="menux" :menuy="menuy"></contextmenu>\n\t\t\t</div>',data:()=>({menux:0,menuy:0}),mounted:function(){this.$root.isDisplayContext=0},methods:{refresh:function(t,e){this.$root.refresh(t,e)},displayError:function(t){this.$root.displayError(t)},back:function(){this.$root.back()},viewFile:function(t,i){this.$root.currentFile=t,this.$root.currentIndex=i,this.checkImageType(t,i)?e.isDisplayWindow="VIEW":this.checkFileEditable(t,i)&&e.editFile(this.successEditFile)},successEditFile:function(t){this.currentFile.content=t.data.content,e.isDisplayWindow="EDIT"},isViewable:function(t,i){return this.$root.currentFile=t,this.$root.currentIndex=i,e.isViewable()},checkFileEditable:function(t,i){return this.$root.currentFile=t,this.$root.currentIndex=i,e.checkFileEditable()},checkImageType:function(t,i){return this.$root.currentFile=t,this.$root.currentIndex=i,e.checkImageType()},checkIsFile:function(){return e.checkIsFile()},openMenu:function(t,e,i,n){this.$root.isDisplayContext=0;var s=Math.floor(document.getElementById("fileitem-"+i).getBoundingClientRect().left),r=Math.floor(document.getElementById("fileitem-"+i).getBoundingClientRect().top)+window.scrollX-5;this.$nextTick(function(){this.$root.isDisplayContext=1}),this.$root.isDisplayWindow="",this.$root.currentFile=e,this.$root.currentFile.index=i,this.$root.currentIndex=i,this.menux=s,this.menuy=r,t.preventDefault()}}}),Vue.component("gridmode",{props:["files","folders","foldertree","isDisplayContext","currentFile"],template:'\n\t\t\t<div class="gridmode-wrapper">\n\t\t\t<div v-if="foldertree.length" class="fileviewer-item" @click="back()">\n\t\t\t\t<div class="fileviewer-item-icon">\n\t\t\t\t<i class="mi-arrow-circle-o-left"></i>\n\t\t\t\t</div>\n\t\t\t\t<div class="fileviewer-item-meta">\n\t\t\t\t<div class="fileviewer-item-label">\n\t\t\t\t\tBack\n\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-for="(file,index) in files">\n\t\t\t\t<div class="fileviewer-item"  :id="\'fileitem-\'+index"  v-if="parseInt(file.isfile)">\n\t\t\t\t\t<div class="fileviewer-item-image"  @click="viewFile(file,index)">\n\t\t\t\t\t\t<div v-if="parseInt(file.isimage)" class="fileviewer-item-icon" :style="{ \'background-image\': \'url(\' + encodeURI(file.url) + \')\' }"></div>\n\t\t\t\t\t\t<div v-else class="fileviewer-item-icon fileviewer-item-filetype" :class="[\'fileviewer-item-icon-\' + file.type]">{{file.ext}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="fileviewer-item-meta">\n\t\t\t\t\t\t<div class="fileviewer-item-label">\n\t\t\t\t\t\t{{file.fullname}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="fileviewer-item-meta-details">\n\t\t\t\t\t\t\t<div v-if="parseInt(file.isfile)" class="fileviewer-item-meta-size">\n\t\t\t\t\t\t\t\t{{file.size}}kb\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<i :id="\'btn-\'+index" class="btn mi-ellipsis-v" @click="openMenu($event,file,index)"></i>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="fileviewer-item" :id="\'fileitem-\'+index" v-else>\n\t\t\t\t\t<div class="fileviewer-item-icon" @click="refresh(file.name)">\n\t\t\t\t\t\t<i class="mi-folder-open"></i>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="fileviewer-item-meta">\n\t\t\t\t\t\t<div class="fileviewer-item-label">\n\t\t\t\t\t\t{{file.fullname}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="fileviewer-item-meta-details">\n\t\t\t\t\t\t\t<div v-if="parseInt(file.isfile)" class="fileviewer-item-meta-size">\n\t\t\t\t\t\t\t\t{{file.size}}kb\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<i :id="\'btn-\'+index" class="btn mi-ellipsis-v" @click="openMenu($event,file,index)"></i>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="clearfix"></div>\n\t\t\t<contextmenu :currentFile="this.$parent.currentFile" :isDisplayContext="isDisplayContext" v-if="isDisplayContext" :menux="menux" :menuy="menuy"></contextmenu>\n\t\t\t</div>',data:()=>({menux:0,menuy:0,offsetx:0,offsety:0}),mounted:function(){this.$root.isDisplayContext=0},methods:{refresh:function(t,e){this.$root.refresh(t,e)},back:function(){this.$root.back()},viewFile:function(t,i){this.$root.currentFile=t,this.$root.currentIndex=i,parseInt(t.isimage)?(e.isDisplayWindow="VIEW",e.viewFile()):this.openMenu(null,t,i)},openMenu:function(t,e,i){window.index=i,window.gridMode=!0;var n=135,s=-3;document.getElementById("MasaBrowserContainer")&&document.getElementById("MasaBrowserContainer").parentNode==document.getElementById("alertDialogMessage")&&(s+=57,n+=Math.floor(document.getElementById("MasaBrowserContainer").getBoundingClientRect().left));var r=document.getElementById("btn-"+i),o=Math.floor(r.getBoundingClientRect().left),l=Math.floor(r.getBoundingClientRect().top),a=170;parseInt(e.isfile)?parseInt(!e.isimage)||(a=108):a=50,this.menux=o-20-n,this.menuy=l-s,this.bottom=window.innerHeight,this.menuy+a+25>this.bottom&&(this.menuy-=a+7),this.$root.currentFile=e,this.$root.currentIndex=i,this.$root.isDisplayContext=0,this.$nextTick(function(){this.$root.isDisplayContext=1}),this.$root.isDisplayWindow="",this.$root.currentFile=e,this.$root.currentFile.index=i,this.$root.currentIndex=i,null!=t&&t.preventDefault()}}}),Vue.component("filewindow",{props:["files","folders","foldertree","isDisplayContext","currentFile","settings","displaymode"],template:'\n\t\t\t<div class="filewindow-wrapper">\n\t\t\t<gridmode v-if="displaymode==1" :currentFile="currentFile" :foldertree="foldertree" :files="files" :folders="folders" :isDisplayContext="isDisplayContext"></gridmode>\n\t\t\t<listmode  v-if="displaymode==2" :settings="settings" :currentFile="currentFile" :foldertree="foldertree" :files="files" :folders="folders" :isDisplayContext="isDisplayContext"></listmode>\n\t\t\t</div>',data:()=>({}),methods:{}}),Vue.component("spinner",{template:'\n\t\t\t<div id="spinner">\n\t\n\t\t\t</div>',data:()=>({}),mounted:function(){$("#spinner").spin(spinnerArgs)},destroyed:function(){$("#spinner").spin(!1)},methods:{}});var e=new Vue({el:"#"+t.target,template:'\n\t\t\t<div class="fileviewer-wrapper">\n\t\t\t<spinner v-if="spinnermodal"></spinner>\n\t\t\t<div v-if="message" class="alert alert-error">\n\t\t\t\t<span>\n\t\t\t\t{{message}}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t<gallerywindow v-if="isDisplayWindow==\'VIEW\'" :settings="settings" :currentFile="currentFile" :currentIndex="currentIndex"></gallerywindow>\n\t\t\t<imageeditwindow v-if="isDisplayWindow==\'EDITIMAGE\'" :settings="settings" :currentFile="currentFile" :currentIndex="currentIndex"></imageeditwindow>\n\t\t\t<actionwindow v-if="isDisplayWindow" :settings="settings" :isDisplayWindow="isDisplayWindow" :currentIndex="currentIndex" :foldertree="foldertree" :currentFile="currentFile" :error="error"></actionwindow>\n\t\t\t<div class="mura-header">\n\t\t\t\t<ul class="breadcrumb">\n\t\t\t\t<li @click="setDirDepth(-1)"><a><i class="mi-home"></i>{{resourcepath}}</a></li>\n\t\t\t\t<li v-for="(item,index) in foldertree" @click="setDirDepth(index)"><a><i class="mi-folder-open"></i>{{item}}</a></li>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t\t<div class="mura-header" id="fileviewer-message" v-if="isErrorMessage">\n\t\t\t\t<div class="alert alert-error">\n\t\t\t\t\t<span v-html="renderer(this.errorMessage)"></span>\n\t\t\t\t</div>\t\n\t\t\t</div>\n\t\t\t<div class="fileviewer-droptarget">\n\t\t\t\t<form enctype="multipart/form-data" novalidate v-if="isStart || isSave">\n\t\t\t\t<input type="file" multiple :name="uploadField" :disabled="isSave" @change="filesChanged($event.target.name, $event.target.files);" accept="*.*" class="file-input-field">\n\t\t\t\t<p v-if="isStart" class="upload-icon">\n\t\t\t\t\t{{settings.rb.filebrowser_draghere}}\n\t\t\t\t</p>\n\t\t\t\t<p v-if="isSave" class="download-icon">\n\t\t\t\t\t{{settings.rb.filebrowser_uploading}} ({{fileCount}})\n\t\t\t\t</p>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t\t<appbar v-if="response.links" :settings="settings" :location=1 :links="response.links" :itemsper="itemsper" :response="response"></appbar>\n\t\t\t<filewindow :settings="settings" :currentFile="currentFile" :isDisplayContext="isDisplayContext" :foldertree="foldertree" :files="files" :folders="folders" :displaymode="displaymode"></filewindow>\n\t\t\t<appbar v-if="response.links" :settings="settings" :location=0 :links="response.links" :itemsper="itemsper" :response="response"></appbar>\n\t\t\t</div>',data:{currentView:"fileviewer",currentState:null,currentFile:null,currentIndex:0,foldertree:[],fileCount:0,rootpath:"",files:[],folders:[],spinnermodal:0,error:"",settings:{rb:{}},displaymode:this.config.displaymode,uploadedFiles:[],isDisplayContext:0,isErrorMessage:0,errorMessage:"",isDisplayWindow:"",uploadField:"uploadFiles",filterResults:"",sortOn:"",sortDir:"ASC",itemsper:25,message:"",editfilelist:t.editfilelist,resourcepath:this.config.resourcepath.replace("_"," "),response:{pageindex:0}},ready:function(){},computed:{isStart(){return 0===this.currentState},isSave(){return 1===this.currentState},isSuccess(){return 2===this.currentState},isonError(){return 3===this.currentState}},methods:{renderer:t=>t,updateDelete:function(){t.updateDelete(currentFile)},updateContent:function(e){for(var i="",n=0;n<this.foldertree.length;n++)i=i+"/"+this.foldertree[n];t.doUpdateContent(i,this.currentFile,e,this.refresh)},renameFile:function(){for(var e="",i=0;i<this.foldertree.length;i++)e=e+"/"+this.foldertree[i];t.doRenameFile(e,this.currentFile,this.refresh)},newFolder:function(e){for(var i="",n=0;n<this.foldertree.length;n++)i=i+"/"+this.foldertree[n];t.doNewFolder(i,e,this.refresh)},updateEdit:function(){t.updateEdit(currentFile)},displayResults:function(t){var e=this;if(this.response=t.data,1==parseInt(this.response.dne)){console.log("Requested folder does not not exist; resetting folder tree to root"),this.foldertree=[];Mura.createCookie("fbFolderTree",JSON.stringify({foldertree:[]}),1),this.$nextTick(function(){e.refresh()})}MuraFileBrowser.rootpath=this.response.rootpath,this.files=this.response.items,this.folders=this.response.folders,this.response.settings&&(this.settings=this.response.settings),this.$nextTick(function(){this.spinnermodal=0})},displayError:function(t){t&&t.message&&(this.message=t.message)},previousFile(t){if(t=t||0,index=this.currentIndex,index--,!(index+1<=0)&&parseInt(this.files[index].isfile))return t&&this.checkImageType()||!t?(this.currentFile=this.files[index],void(this.currentIndex=index)):void this.previousFile(t)},nextFile(t){if(t=t||0,index=this.currentIndex,index++,!(index>=this.files.length))return t&&this.checkImageType()||!t?(this.currentFile=this.files[index],void(this.currentIndex=index)):void this.nextFile(t)},upload:function(){},uploadReset(){this.currentState=0,this.uploadedFiles=[],this.error=null},setDirDepth:function(t){this.foldertree=this.foldertree.slice(0,t+1),this.refresh()},editFile:function(e,i){for(var n="",s=0;s<this.foldertree.length;s++)n=n+"/"+this.foldertree[s];t.getEditFile(n,this.currentFile,e)},viewFile:function(t){},deleteFile:function(e,i){for(var n="",s=0;s<this.foldertree.length;s++)n=n+"/"+this.foldertree[s];t.doDeleteFile(n,this.currentFile,e,i)},duplicateFile:function(e,i){for(var n="",s=0;s<this.foldertree.length;s++)n=n+"/"+this.foldertree[s];t.doDuplicateFile(n,this.currentFile,e,i)},refresh:function(e,i,n){this.spinnermodal=0,1==this.isErrorMessage?this.isErrorMessage=2:2==this.isErrorMessage&&(this.isErrorMessage=0,this.errorMessage=""),n?(this.isDisplayWindow="",this.$nextTick(function(){this.$root.isDisplayWindow=n})):this.isDisplayWindow="",e&&e.length&&this.foldertree.push(e);var s="";isNaN(i);for(var r=0;r<this.foldertree.length;r++)s=s+"/"+this.foldertree[r];this.isDisplayContext="",this.spinnermodal=1;var o={foldertree:JSON.parse(JSON.stringify(this.foldertree))};Mura.createCookie("fbFolderTree",JSON.stringify(o),1),t.loadDirectory(s,i,this.displayResults,this.displayError,this.filterResults,this.sortOn,this.sortDir,this.itemsper,n)},back:function(){this.foldertree.splice(-1);this.foldertree.length||this.foldertree[this.foldertree.length-1];this.refresh()},closeMenu:function(t){this.isDisplayContext=0,t.preventDefault()},filesChanged:function(t,e){this.uploadedFiles=e;const i=new FormData;var n="";if(e.length){this.fileCount=e.length,Array.from(Array(e.length).keys()).map(n=>{i.append(t,e[n],e[n].name)});for(var s=0;s<this.foldertree.length;s++)n=n+"/"+this.foldertree[s];i.append("directory",n),this.save(i)}},save:function(e){this.currentState=1,t.doUpload(e,this.saveComplete)},saveComplete:function(t){if(console.log("SAVED",t),t.failed&&t.failed.length){this.isErrorMessage=1,this.errorMessage="<ul>";for(var e=0;e<t.failed.length;e++)this.errorMessage+="<li><strong>"+t.failed[e].clientfile+":</strong> "+t.failed[e].message+"</li>";this.errorMessage+="</ul>"}this.uploadReset(),this.refresh()},checkSelectMode:function(){return MuraFileBrowser.config.selectMode},isViewable:function(){for(var t=this.settings.editfilelist,e=this.settings.imagelist,i=0;i<t.length;i++)if(this.currentFile.ext.toLowerCase()==t[i])return!0;for(i=0;i<e.length;i++)if(this.currentFile.ext.toLowerCase()==e[i])return!0;return!1},checkFileEditable:function(){for(var t=this.settings.editfilelist,e=0;e<t.length;e++)if(this.currentFile.ext.toLowerCase()==t[e])return!0;return!1},checkImageType:function(){for(var t=this.settings.imagelist,e=0;e<t.length;e++)if(this.currentFile.ext.toLowerCase()==t[e])return!0;return!1},checkIsFile:function(){return!!Math.floor(this.currentFile.isfile)}},mounted:function(){this.uploadReset(),this.$nextTick(function(){this.spinnermodal=1}),this.selectMode=t.config.selectMode;var e="",i=Mura.readCookie("fbFolderTree");if(i){var n=JSON.parse(i);if(n.foldertree){this.$root.foldertree=n.foldertree;for(var s=0;s<this.foldertree.length;s++)e=e+"/"+this.foldertree[s]}}var r=Mura.readCookie("fbDisplayMode");if(r){var o=JSON.parse(r);o.displaymode&&(this.$root.displaymode=this.viewmode=o.displaymode)}t.loadBaseDirectory(this.displayResults,this.displayError,e),window.addEventListener("mouseup",function(t){})}})}};